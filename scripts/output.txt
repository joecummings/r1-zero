INFO 04-07 08:39:49 [__init__.py:256] Automatically detected platform cuda.
2025-04-07 08:39:51,947	INFO worker.py:1841 -- Started a local Ray instance.
[36m(ReplayBuffer( pid=3151205)[0m     storage=LazyStackStorage(), 
[36m(ReplayBuffer( pid=3151205)[0m     sampler=RandomSampler(), 
[36m(ReplayBuffer( pid=3151205)[0m     writer=RoundRobinWriter(cursor=0, full_storage=False), 
[36m(ReplayBuffer( pid=3151205)[0m     batch_size=32, 
[36m(ReplayBuffer( pid=3151205)[0m     collate_fn=<function _collate_id at 0x7ef46ba237e0>)
[36m(PyTorchActorModel pid=3151119)[0m DEBUG:torchtune.utils._logging:Setting manual seed to local seed 2057898222. Local seed is seed + rank = 2057898222 + 0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:FSDP is enabled. Instantiating model and loading checkpoint on Rank 0 ...
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Memory stats after model init:
[36m(RefActor pid=3151242)[0m 	GPU peak memory active: 5.78 GiB
[36m(RefActor pid=3151242)[0m 	GPU peak memory alloc: 5.78 GiB
[36m(RefActor pid=3151242)[0m 	GPU peak memory reserved: 5.79 GiB
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Instantiating model and loading checkpoint took 3.11 secs
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Memory stats after model init:
[36m(PyTorchActorModel pid=3151119)[0m 	GPU peak memory active: 2.94 GiB
[36m(PyTorchActorModel pid=3151119)[0m 	GPU peak memory alloc: 2.94 GiB
[36m(PyTorchActorModel pid=3151119)[0m 	GPU peak memory reserved: 3.01 GiB
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Optimizer is initialized.
[36m(PyTorchActorModel pid=3151119)[0m WARNING:torchtune.utils._logging: Profiling disabled.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Profiler config after instantiation: {'enabled': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done setup
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Done setup
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:running ref actor
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Setting metric logger Actor(MetricLoggerActor, 0249b3c3f640fab3050fc2ba01000000) for rank 0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:registered collector worker_id=0
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:registered collector worker_id=1
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:registered collector worker_id=3
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:registered collector worker_id=2
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(MetricLoggerActor pid=3151248)[0m wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(MetricLoggerActor pid=3151248)[0m wandb: Currently logged in as: fmello to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(MetricLoggerActor pid=3151248)[0m wandb: Tracking run with wandb version 0.19.8
[36m(MetricLoggerActor pid=3151248)[0m wandb: Run data is saved locally in /tmp/checkpoints/grpo_qwen3b/logs/wandb/run-20250407_084015-5oca1ov5
[36m(MetricLoggerActor pid=3151248)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(MetricLoggerActor pid=3151248)[0m wandb: Syncing run clear-jazz-804
[36m(MetricLoggerActor pid=3151248)[0m wandb: ‚≠êÔ∏è View project at https://wandb.ai/fmello/torchtune
[36m(MetricLoggerActor pid=3151248)[0m wandb: üöÄ View run at https://wandb.ai/fmello/torchtune/runs/5oca1ov5
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(ReplayBuffer( pid=3151205)[0m     storage=LazyStackStorage(), 
[36m(ReplayBuffer( pid=3151205)[0m     sampler=RandomSampler(), 
[36m(ReplayBuffer( pid=3151205)[0m     writer=RoundRobinWriter(cursor=0, full_storage=False), 
[36m(ReplayBuffer( pid=3151205)[0m     batch_size=32, 
[36m(ReplayBuffer( pid=3151205)[0m     collate_fn=<function _collate_id at 0x7ef46ba237e0>)
[36m(PyTorchActorModel pid=3151119)[0m NCCL version 2.21.5+cuda12.4
[36m(RefActor pid=3151242)[0m done setting up ref model
[36m(PyTorchActorModel pid=3151119)[0m pad_id: 151643, token 4607: ?., token 21388:  Assistant
[36m(PyTorchActorModel pid=3151076)[0m pad_id: 151643, token 4607: ?., token 21388:  Assistant
[36m(RefActor pid=3151242)[0m setting metric logger Actor(MetricLoggerActor, 0249b3c3f640fab3050fc2ba01000000) for actor id 0
[36m(vLLMParameterServer pid=3151482)[0m INFO 04-07 08:40:11 [__init__.py:256] Automatically detected platform cuda.
[36m(pid=3151206)[0m INFO 04-07 08:40:14 [__init__.py:256] Automatically detected platform cuda.
[36m(pid=3151108)[0m INFO 04-07 08:40:15 [__init__.py:256] Automatically detected platform cuda.
[36m(pid=3151212)[0m INFO 04-07 08:40:15 [__init__.py:256] Automatically detected platform cuda.
[36m(pid=3151100)[0m INFO 04-07 08:40:16 [__init__.py:256] Automatically detected platform cuda.
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:25 [config.py:583] This model supports multiple tasks: {'embed', 'score', 'classify', 'generate', 'reward'}. Defaulting to 'generate'.
[36m(LLMCollector pid=3151206)[0m WARNING 04-07 08:40:25 [arg_utils.py:1754] --worker-cls is not supported by the V1 Engine. Falling back to V0. 
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:25 [config.py:1693] Chunked prefill is enabled with max_num_batched_tokens=2048.
[36m(LLMCollector pid=3151206)[0m WARNING 04-07 08:40:25 [cuda.py:95] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:25 [llm_engine.py:241] Initializing a V0 LLM engine (v0.8.0) with config: model='Qwen/Qwen2.5-3B', speculative_config=None, tokenizer='Qwen/Qwen2.5-3B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=Qwen/Qwen2.5-3B, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=None, chunked_prefill_enabled=True, use_async_output_proc=False, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":[],"compile_sizes":[],"cudagraph_capture_sizes":[],"max_capture_size":0}, use_cached_outputs=False, 
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:25 [config.py:583] This model supports multiple tasks: {'reward', 'generate', 'embed', 'classify', 'score'}. Defaulting to 'generate'.
[36m(LLMCollector pid=3151212)[0m WARNING 04-07 08:40:25 [arg_utils.py:1754] --worker-cls is not supported by the V1 Engine. Falling back to V0. 
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:25 [config.py:1693] Chunked prefill is enabled with max_num_batched_tokens=2048.
[36m(LLMCollector pid=3151212)[0m WARNING 04-07 08:40:25 [cuda.py:95] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:25 [llm_engine.py:241] Initializing a V0 LLM engine (v0.8.0) with config: model='Qwen/Qwen2.5-3B', speculative_config=None, tokenizer='Qwen/Qwen2.5-3B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=Qwen/Qwen2.5-3B, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=None, chunked_prefill_enabled=True, use_async_output_proc=False, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":[],"compile_sizes":[],"cudagraph_capture_sizes":[],"max_capture_size":0}, use_cached_outputs=False, 
[36m(LLMCollector pid=3151206)[0m WARNING 04-07 08:40:25 [worker_base.py:561] passing worker_cls as a class object is strongly deprecated, as the serialization of class objects can be tricky and error-prone. To be safe, please keep the class in a separate module and pass the qualified name of the class as a string.
[36m(LLMCollector pid=3151206)[0m visible devices 4
[36m(LLMCollector pid=3151206)[0m device count 1
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:25 [cuda.py:285] Using Flash Attention backend.
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:25 [config.py:583] This model supports multiple tasks: {'generate', 'score', 'embed', 'reward', 'classify'}. Defaulting to 'generate'.
[36m(LLMCollector pid=3151108)[0m WARNING 04-07 08:40:25 [arg_utils.py:1754] --worker-cls is not supported by the V1 Engine. Falling back to V0. 
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:25 [config.py:1693] Chunked prefill is enabled with max_num_batched_tokens=2048.
[36m(LLMCollector pid=3151108)[0m WARNING 04-07 08:40:25 [cuda.py:95] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:25 [llm_engine.py:241] Initializing a V0 LLM engine (v0.8.0) with config: model='Qwen/Qwen2.5-3B', speculative_config=None, tokenizer='Qwen/Qwen2.5-3B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=Qwen/Qwen2.5-3B, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=None, chunked_prefill_enabled=True, use_async_output_proc=False, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":[],"compile_sizes":[],"cudagraph_capture_sizes":[],"max_capture_size":0}, use_cached_outputs=False, 
[36m(LLMCollector pid=3151212)[0m WARNING 04-07 08:40:26 [worker_base.py:561] passing worker_cls as a class object is strongly deprecated, as the serialization of class objects can be tricky and error-prone. To be safe, please keep the class in a separate module and pass the qualified name of the class as a string.
[36m(LLMCollector pid=3151212)[0m visible devices 7
[36m(LLMCollector pid=3151212)[0m device count 1
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:26 [cuda.py:285] Using Flash Attention backend.[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(LLMCollector pid=3151206)[0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[36m(LLMCollector pid=3151212)[0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(LLMCollector pid=3151108)[0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(LLMCollector pid=3151100)[0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[36m(LLMCollector pid=3151206)[0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.50s/it]
[36m(LLMCollector pid=3151212)[0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.34s/it]
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(LLMCollector pid=3151108)[0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.36s/it]
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(LLMCollector pid=3151206)[0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.20s/it]
[36m(LLMCollector pid=3151206)[0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.24s/it]
[36m(LLMCollector pid=3151206)[0m 
[36m(LLMCollector pid=3151212)[0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.14s/it]
[36m(LLMCollector pid=3151212)[0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.17s/it]
[36m(LLMCollector pid=3151212)[0m 
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(LLMCollector pid=3151100)[0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.44s/it]
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(LLMCollector pid=3151108)[0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.10s/it]
[36m(LLMCollector pid=3151108)[0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.14s/it]
[36m(LLMCollector pid=3151108)[0m 
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(LLMCollector pid=3151100)[0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.20s/it]
[36m(LLMCollector pid=3151100)[0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.23s/it]
[36m(LLMCollector pid=3151100)[0m 
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.

[36m(LLMCollector pid=3151108)[0m WARNING 04-07 08:40:26 [worker_base.py:561] passing worker_cls as a class object is strongly deprecated, as the serialization of class objects can be tricky and error-prone. To be safe, please keep the class in a separate module and pass the qualified name of the class as a string.
[36m(LLMCollector pid=3151108)[0m visible devices 5
[36m(LLMCollector pid=3151108)[0m device count 1
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:26 [config.py:583] This model supports multiple tasks: {'reward', 'classify', 'embed', 'generate', 'score'}. Defaulting to 'generate'.
[36m(LLMCollector pid=3151100)[0m WARNING 04-07 08:40:26 [arg_utils.py:1754] --worker-cls is not supported by the V1 Engine. Falling back to V0. 
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:26 [config.py:1693] Chunked prefill is enabled with max_num_batched_tokens=2048.
[36m(LLMCollector pid=3151100)[0m WARNING 04-07 08:40:26 [cuda.py:95] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:26 [llm_engine.py:241] Initializing a V0 LLM engine (v0.8.0) with config: model='Qwen/Qwen2.5-3B', speculative_config=None, tokenizer='Qwen/Qwen2.5-3B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=Qwen/Qwen2.5-3B, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=None, chunked_prefill_enabled=True, use_async_output_proc=False, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":[],"compile_sizes":[],"cudagraph_capture_sizes":[],"max_capture_size":0}, use_cached_outputs=False, 
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:26 [cuda.py:285] Using Flash Attention backend.
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:26 [parallel_state.py:967] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:26 [model_runner.py:1110] Starting to load model Qwen/Qwen2.5-3B...
[36m(LLMCollector pid=3151100)[0m WARNING 04-07 08:40:27 [worker_base.py:561] passing worker_cls as a class object is strongly deprecated, as the serialization of class objects can be tricky and error-prone. To be safe, please keep the class in a separate module and pass the qualified name of the class as a string.
[36m(LLMCollector pid=3151100)[0m visible devices 6
[36m(LLMCollector pid=3151100)[0m device count 1
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:27 [cuda.py:285] Using Flash Attention backend.
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:27 [parallel_state.py:967] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:27 [model_runner.py:1110] Starting to load model Qwen/Qwen2.5-3B...
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:27 [parallel_state.py:967] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:27 [model_runner.py:1110] Starting to load model Qwen/Qwen2.5-3B...
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:28 [weight_utils.py:257] Using model weights format ['*.safetensors']
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:28 [parallel_state.py:967] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:28 [model_runner.py:1110] Starting to load model Qwen/Qwen2.5-3B...
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:28 [weight_utils.py:257] Using model weights format ['*.safetensors']
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:29 [weight_utils.py:257] Using model weights format ['*.safetensors']
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:29 [weight_utils.py:257] Using model weights format ['*.safetensors']
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:31 [loader.py:429] Loading weights took 2.58 seconds
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:31 [loader.py:429] Loading weights took 2.41 seconds
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:31 [model_runner.py:1146] Model loading took 5.7559 GB and 4.209908 seconds
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:31 [model_runner.py:1146] Model loading took 5.7559 GB and 3.637775 seconds
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:31 [loader.py:429] Loading weights took 2.40 seconds
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:32 [model_runner.py:1146] Model loading took 5.7559 GB and 3.933758 seconds
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:32 [loader.py:429] Loading weights took 2.60 seconds
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:32 [model_runner.py:1146] Model loading took 5.7559 GB and 3.942479 seconds
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:33 [worker.py:267] Memory profiling takes 1.86 seconds
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:33 [worker.py:267] the current vLLM instance can use total_gpu_memory (79.15GiB) x gpu_memory_utilization (0.90) = 71.24GiB
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:33 [worker.py:267] model weights take 5.76GiB; non_torch_memory takes 0.09GiB; PyTorch activation peak memory takes 1.39GiB; the rest of the memory reserved for KV Cache is 64.00GiB.
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:33 [worker.py:267] Memory profiling takes 1.68 seconds
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:33 [worker.py:267] the current vLLM instance can use total_gpu_memory (79.15GiB) x gpu_memory_utilization (0.90) = 71.24GiB
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:33 [worker.py:267] model weights take 5.76GiB; non_torch_memory takes 0.09GiB; PyTorch activation peak memory takes 1.39GiB; the rest of the memory reserved for KV Cache is 64.00GiB.
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:34 [executor_base.py:111] # cuda blocks: 116500, # CPU blocks: 7281
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:34 [executor_base.py:116] Maximum concurrency for 32768 tokens per request: 56.88x
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:34 [executor_base.py:111] # cuda blocks: 116500, # CPU blocks: 7281
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:34 [executor_base.py:116] Maximum concurrency for 32768 tokens per request: 56.88x
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:34 [worker.py:267] Memory profiling takes 1.68 seconds
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:34 [worker.py:267] the current vLLM instance can use total_gpu_memory (79.15GiB) x gpu_memory_utilization (0.90) = 71.24GiB
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:34 [worker.py:267] model weights take 5.76GiB; non_torch_memory takes 0.09GiB; PyTorch activation peak memory takes 1.39GiB; the rest of the memory reserved for KV Cache is 64.00GiB.
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:34 [executor_base.py:111] # cuda blocks: 116500, # CPU blocks: 7281
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:34 [executor_base.py:116] Maximum concurrency for 32768 tokens per request: 56.88x
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:35 [worker.py:267] Memory profiling takes 1.59 seconds
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:35 [worker.py:267] the current vLLM instance can use total_gpu_memory (79.15GiB) x gpu_memory_utilization (0.90) = 71.24GiB
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:35 [worker.py:267] model weights take 5.76GiB; non_torch_memory takes 0.09GiB; PyTorch activation peak memory takes 1.39GiB; the rest of the memory reserved for KV Cache is 64.00GiB.[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(LLMCollector pid=3151206)[0m /data/users/felipemello/rl/torchrl/collectors/collectors.py:844: UserWarning: frames_per_batch (1) is not exactly divisible by the number of batched environments (16),  this results in more frames_per_batch per iteration that requested (16). To silence this message, set the environment variable RL_WARNINGS to False.
[36m(LLMCollector pid=3151206)[0m   warnings.warn(
[36m(LLMCollector pid=3151206)[0m INFO:torchtune.utils._logging:done init LLMCollector
[36m(LLMCollector( pid=3151206)[0m     env=TransformedEnv(
[36m(LLMCollector( pid=3151206)[0m         env=LLMEnv(),
[36m(LLMCollector( pid=3151206)[0m         transform=DataLoadingPrimer(primers=Composite(
[36m(LLMCollector( pid=3151206)[0m             tokens: UnboundedDiscrete(
[36m(LLMCollector( pid=3151206)[0m                 shape=torch.Size([16, -1]),
[36m(LLMCollector( pid=3151206)[0m                 space=ContinuousBox(
[36m(LLMCollector( pid=3151206)[0m                     low=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True),
[36m(LLMCollector( pid=3151206)[0m                     high=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True)),
[36m(LLMCollector( pid=3151206)[0m                 device=cpu,
[36m(LLMCollector( pid=3151206)[0m                 dtype=torch.int64,
[36m(LLMCollector( pid=3151206)[0m                 domain=discrete),
[36m(LLMCollector( pid=3151206)[0m             answers: NonTensor(
[36m(LLMCollector( pid=3151206)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151206)[0m                 space=None,
[36m(LLMCollector( pid=3151206)[0m                 device=None,
[36m(LLMCollector( pid=3151206)[0m                 dtype=None,
[36m(LLMCollector( pid=3151206)[0m                 domain=None,
[36m(LLMCollector( pid=3151206)[0m                 example_data=10),
[36m(LLMCollector( pid=3151206)[0m             text: NonTensor(
[36m(LLMCollector( pid=3151206)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151206)[0m                 space=None,
[36m(LLMCollector( pid=3151206)[0m                 device=None,
[36m(LLMCollector( pid=3151206)[0m                 dtype=None,
[36m(LLMCollector( pid=3151206)[0m                 domain=None,
[36m(LLMCollector( pid=3151206)[0m                 example_data=A conversation between User and Assistant. The user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user with the answer. The reasoning process and answer are enclosed within <think></think> and <answer></answer> tags, respectively, i.e., <think>reasoning process here</think> <answer>answer here</answer>. User: Weng earns $12 an hour for babysitting. Yesterday, she just did 50 minutes of babysitting. How much did she earn?. Assistant: <think>),
[36m(LLMCollector( pid=3151206)[0m             device=None,
[36m(LLMCollector( pid=3151206)[0m             shape=torch.Size([16])), dataloader=<torchdata.stateful_dataloader.stateful_dataloader.StatefulDataLoader object at 0x7f07649a4d10>)),
[36m(LLMCollector( pid=3151206)[0m     policy=<function vllm_generate at 0x7f07e410bce0>,
[36m(LLMCollector( pid=3151206)[0m     td_out=None,
[36m(LLMCollector( pid=3151206)[0m exploration=random)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(LLMCollector pid=3151212)[0m /data/users/felipemello/rl/torchrl/collectors/collectors.py:844: UserWarning: frames_per_batch (1) is not exactly divisible by the number of batched environments (16),  this results in more frames_per_batch per iteration that requested (16). To silence this message, set the environment variable RL_WARNINGS to False.
[36m(LLMCollector pid=3151212)[0m   warnings.warn(
[36m(LLMCollector pid=3151212)[0m INFO:torchtune.utils._logging:done init LLMCollector
[36m(LLMCollector( pid=3151212)[0m     env=TransformedEnv(
[36m(LLMCollector( pid=3151212)[0m         env=LLMEnv(),
[36m(LLMCollector( pid=3151212)[0m         transform=DataLoadingPrimer(primers=Composite(
[36m(LLMCollector( pid=3151212)[0m             tokens: UnboundedDiscrete(
[36m(LLMCollector( pid=3151212)[0m                 shape=torch.Size([16, -1]),
[36m(LLMCollector( pid=3151212)[0m                 space=ContinuousBox(
[36m(LLMCollector( pid=3151212)[0m                     low=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True),
[36m(LLMCollector( pid=3151212)[0m                     high=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True)),
[36m(LLMCollector( pid=3151212)[0m                 device=cpu,
[36m(LLMCollector( pid=3151212)[0m                 dtype=torch.int64,
[36m(LLMCollector( pid=3151212)[0m                 domain=discrete),
[36m(LLMCollector( pid=3151212)[0m             answers: NonTensor(
[36m(LLMCollector( pid=3151212)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151212)[0m                 space=None,
[36m(LLMCollector( pid=3151212)[0m                 device=None,
[36m(LLMCollector( pid=3151212)[0m                 dtype=None,
[36m(LLMCollector( pid=3151212)[0m                 domain=None,
[36m(LLMCollector( pid=3151212)[0m                 example_data=10),
[36m(LLMCollector( pid=3151212)[0m             text: NonTensor(
[36m(LLMCollector( pid=3151212)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151212)[0m                 space=None,
[36m(LLMCollector( pid=3151212)[0m                 device=None,
[36m(LLMCollector( pid=3151212)[0m                 dtype=None,
[36m(LLMCollector( pid=3151212)[0m                 domain=None,
[36m(LLMCollector( pid=3151212)[0m                 example_data=A conversation between User and Assistant. The user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user with the answer. The reasoning process and answer are enclosed within <think></think> and <answer></answer> tags, respectively, i.e., <think>reasoning process here</think> <answer>answer here</answer>. User: Weng earns $12 an hour for babysitting. Yesterday, she just did 50 minutes of babysitting. How much did she earn?. Assistant: <think>),
[36m(LLMCollector( pid=3151212)[0m             device=None,
[36m(LLMCollector( pid=3151212)[0m             shape=torch.Size([16])), dataloader=<torchdata.stateful_dataloader.stateful_dataloader.StatefulDataLoader object at 0x7eda1450af90>)),
[36m(LLMCollector( pid=3151212)[0m     policy=<function vllm_generate at 0x7eda3b83bce0>,
[36m(LLMCollector( pid=3151212)[0m     td_out=None,
[36m(LLMCollector( pid=3151212)[0m exploration=random)

[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:35 [executor_base.py:111] # cuda blocks: 116500, # CPU blocks: 7281
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:35 [executor_base.py:116] Maximum concurrency for 32768 tokens per request: 56.88x
[36m(LLMCollector pid=3151206)[0m INFO 04-07 08:40:40 [llm_engine.py:447] init engine (profile, create kv cache, warmup model) took 8.82 seconds
[36m(LLMCollector pid=3151212)[0m INFO 04-07 08:40:40 [llm_engine.py:447] init engine (profile, create kv cache, warmup model) took 8.93 seconds
[36m(LLMCollector pid=3151100)[0m INFO 04-07 08:40:40 [llm_engine.py:447] init engine (profile, create kv cache, warmup model) took 7.86 seconds
[36m(LLMCollector pid=3151108)[0m INFO 04-07 08:40:40 [llm_engine.py:447] init engine (profile, create kv cache, warmup model) took 8.73 seconds
[36m(LLMCollector( pid=3151206)[0m     env=TransformedEnv(
[36m(LLMCollector( pid=3151206)[0m         env=LLMEnv(),
[36m(LLMCollector( pid=3151206)[0m         transform=DataLoadingPrimer(primers=Composite(
[36m(LLMCollector( pid=3151206)[0m             tokens: UnboundedDiscrete(
[36m(LLMCollector( pid=3151206)[0m                 shape=torch.Size([16, -1]),
[36m(LLMCollector( pid=3151206)[0m                 space=ContinuousBox(
[36m(LLMCollector( pid=3151206)[0m                     low=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True),
[36m(LLMCollector( pid=3151206)[0m                     high=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True)),
[36m(LLMCollector( pid=3151206)[0m                 device=cpu,
[36m(LLMCollector( pid=3151206)[0m                 dtype=torch.int64,
[36m(LLMCollector( pid=3151206)[0m                 domain=discrete),
[36m(LLMCollector( pid=3151206)[0m             answers: NonTensor(
[36m(LLMCollector( pid=3151206)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151206)[0m                 space=None,
[36m(LLMCollector( pid=3151206)[0m                 device=None,
[36m(LLMCollector( pid=3151206)[0m                 dtype=None,
[36m(LLMCollector( pid=3151206)[0m                 domain=None,
[36m(LLMCollector( pid=3151206)[0m                 example_data=10),
[36m(LLMCollector( pid=3151206)[0m             text: NonTensor(
[36m(LLMCollector( pid=3151206)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151206)[0m                 space=None,
[36m(LLMCollector( pid=3151206)[0m                 device=None,
[36m(LLMCollector( pid=3151206)[0m                 dtype=None,
[36m(LLMCollector( pid=3151206)[0m                 domain=None,
[36m(LLMCollector( pid=3151206)[0m                 example_data=A conversation between User and Assistant. The user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user with the answer. The reasoning process and answer are enclosed within <think></think> and <answer></answer> tags, respectively, i.e., <think>reasoning process here</think> <answer>answer here</answer>. User: Weng earns $12 an hour for babysitting. Yesterday, she just did 50 minutes of babysitting. How much did she earn?. Assistant: <think>),
[36m(LLMCollector( pid=3151206)[0m             device=None,
[36m(LLMCollector( pid=3151206)[0m             shape=torch.Size([16])), dataloader=<torchdata.stateful_dataloader.stateful_dataloader.StatefulDataLoader object at 0x7f07649a4d10>)),
[36m(LLMCollector( pid=3151206)[0m     policy=<function vllm_generate at 0x7f07e410bce0>,
[36m(LLMCollector( pid=3151206)[0m     td_out=None,
[36m(LLMCollector( pid=3151206)[0m exploration=random)
[36m(LLMCollector( pid=3151212)[0m     env=TransformedEnv(
[36m(LLMCollector( pid=3151212)[0m         env=LLMEnv(),
[36m(LLMCollector( pid=3151212)[0m         transform=DataLoadingPrimer(primers=Composite(
[36m(LLMCollector( pid=3151212)[0m             tokens: UnboundedDiscrete(
[36m(LLMCollector( pid=3151212)[0m                 shape=torch.Size([16, -1]),
[36m(LLMCollector( pid=3151212)[0m                 space=ContinuousBox(
[36m(LLMCollector( pid=3151212)[0m                     low=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True),
[36m(LLMCollector( pid=3151212)[0m                     high=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True)),
[36m(LLMCollector( pid=3151212)[0m                 device=cpu,
[36m(LLMCollector( pid=3151212)[0m                 dtype=torch.int64,
[36m(LLMCollector( pid=3151212)[0m                 domain=discrete),
[36m(LLMCollector( pid=3151212)[0m             answers: NonTensor(
[36m(LLMCollector( pid=3151212)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151212)[0m                 space=None,
[36m(LLMCollector( pid=3151212)[0m                 device=None,
[36m(LLMCollector( pid=3151212)[0m                 dtype=None,
[36m(LLMCollector( pid=3151212)[0m                 domain=None,
[36m(LLMCollector( pid=3151212)[0m                 example_data=10),
[36m(LLMCollector( pid=3151212)[0m             text: NonTensor(
[36m(LLMCollector( pid=3151212)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151212)[0m                 space=None,
[36m(LLMCollector( pid=3151212)[0m                 device=None,
[36m(LLMCollector( pid=3151212)[0m                 dtype=None,
[36m(LLMCollector( pid=3151212)[0m                 domain=None,
[36m(LLMCollector( pid=3151212)[0m                 example_data=A conversation between User and Assistant. The user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user with the answer. The reasoning process and answer are enclosed within <think></think> and <answer></answer> tags, respectively, i.e., <think>reasoning process here</think> <answer>answer here</answer>. User: Weng earns $12 an hour for babysitting. Yesterday, she just did 50 minutes of babysitting. How much did she earn?. Assistant: <think>),
[36m(LLMCollector( pid=3151212)[0m             device=None,
[36m(LLMCollector( pid=3151212)[0m             shape=torch.Size([16])), dataloader=<torchdata.stateful_dataloader.stateful_dataloader.StatefulDataLoader object at 0x7eda1450af90>)),
[36m(LLMCollector( pid=3151212)[0m     policy=<function vllm_generate at 0x7eda3b83bce0>,
[36m(LLMCollector( pid=3151212)[0m     td_out=None,
[36m(LLMCollector( pid=3151212)[0m exploration=random)
[36m(LLMCollector( pid=3151100)[0m     env=TransformedEnv(
[36m(LLMCollector( pid=3151100)[0m         env=LLMEnv(),
[36m(LLMCollector( pid=3151100)[0m         transform=DataLoadingPrimer(primers=Composite(
[36m(LLMCollector( pid=3151100)[0m             tokens: UnboundedDiscrete(
[36m(LLMCollector( pid=3151100)[0m                 shape=torch.Size([16, -1]),
[36m(LLMCollector( pid=3151100)[0m                 space=ContinuousBox(
[36m(LLMCollector( pid=3151100)[0m                     low=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True),
[36m(LLMCollector( pid=3151100)[0m                     high=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True)),
[36m(LLMCollector( pid=3151100)[0m                 device=cpu,
[36m(LLMCollector( pid=3151100)[0m                 dtype=torch.int64,
[36m(LLMCollector( pid=3151100)[0m                 domain=discrete),
[36m(LLMCollector( pid=3151100)[0m             answers: NonTensor(
[36m(LLMCollector( pid=3151100)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151100)[0m                 space=None,
[36m(LLMCollector( pid=3151100)[0m                 device=None,
[36m(LLMCollector( pid=3151100)[0m                 dtype=None,
[36m(LLMCollector( pid=3151100)[0m                 domain=None,
[36m(LLMCollector( pid=3151100)[0m                 example_data=10),
[36m(LLMCollector( pid=3151100)[0m             text: NonTensor(
[36m(LLMCollector( pid=3151100)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151100)[0m                 space=None,[36m(LLMCollector pid=3151100)[0m /data/users/felipemello/rl/torchrl/collectors/collectors.py:844: UserWarning: frames_per_batch (1) is not exactly divisible by the number of batched environments (16),  this results in more frames_per_batch per iteration that requested (16). To silence this message, set the environment variable RL_WARNINGS to False.
[36m(LLMCollector pid=3151100)[0m   warnings.warn(
[36m(LLMCollector pid=3151100)[0m INFO:torchtune.utils._logging:done init LLMCollector
[36m(LLMCollector( pid=3151100)[0m     env=TransformedEnv(
[36m(LLMCollector( pid=3151100)[0m         env=LLMEnv(),
[36m(LLMCollector( pid=3151100)[0m         transform=DataLoadingPrimer(primers=Composite(
[36m(LLMCollector( pid=3151100)[0m             tokens: UnboundedDiscrete(
[36m(LLMCollector( pid=3151100)[0m                 shape=torch.Size([16, -1]),
[36m(LLMCollector( pid=3151100)[0m                 space=ContinuousBox(
[36m(LLMCollector( pid=3151100)[0m                     low=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True),
[36m(LLMCollector( pid=3151100)[0m                     high=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True)),
[36m(LLMCollector( pid=3151100)[0m                 device=cpu,
[36m(LLMCollector( pid=3151100)[0m                 dtype=torch.int64,
[36m(LLMCollector( pid=3151100)[0m                 domain=discrete),
[36m(LLMCollector( pid=3151100)[0m             answers: NonTensor(
[36m(LLMCollector( pid=3151100)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151100)[0m                 space=None,
[36m(LLMCollector( pid=3151100)[0m                 device=None,
[36m(LLMCollector( pid=3151100)[0m                 dtype=None,
[36m(LLMCollector( pid=3151100)[0m                 domain=None,
[36m(LLMCollector( pid=3151100)[0m                 example_data=10),
[36m(LLMCollector( pid=3151100)[0m             text: NonTensor(
[36m(LLMCollector( pid=3151100)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151100)[0m                 space=None,
[36m(LLMCollector( pid=3151100)[0m                 device=None,
[36m(LLMCollector( pid=3151100)[0m                 dtype=None,
[36m(LLMCollector( pid=3151100)[0m                 domain=None,
[36m(LLMCollector( pid=3151100)[0m                 example_data=A conversation between User and Assistant. The user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user with the answer. The reasoning process and answer are enclosed within <think></think> and <answer></answer> tags, respectively, i.e., <think>reasoning process here</think> <answer>answer here</answer>. User: Weng earns $12 an hour for babysitting. Yesterday, she just did 50 minutes of babysitting. How much did she earn?. Assistant: <think>),
[36m(LLMCollector( pid=3151100)[0m             device=None,
[36m(LLMCollector( pid=3151100)[0m             shape=torch.Size([16])), dataloader=<torchdata.stateful_dataloader.stateful_dataloader.StatefulDataLoader object at 0x7f27c4159490>)),
[36m(LLMCollector( pid=3151100)[0m     policy=<function vllm_generate at 0x7f2819097ce0>,
[36m(LLMCollector( pid=3151100)[0m     td_out=None,
[36m(LLMCollector( pid=3151100)[0m exploration=random)
[36m(LLMCollector pid=3151108)[0m /data/users/felipemello/rl/torchrl/collectors/collectors.py:844: UserWarning: frames_per_batch (1) is not exactly divisible by the number of batched environments (16),  this results in more frames_per_batch per iteration that requested (16). To silence this message, set the environment variable RL_WARNINGS to False.
[36m(LLMCollector pid=3151108)[0m   warnings.warn(
[36m(LLMCollector pid=3151108)[0m INFO:torchtune.utils._logging:done init LLMCollector
[36m(LLMCollector( pid=3151108)[0m     env=TransformedEnv(
[36m(LLMCollector( pid=3151108)[0m         env=LLMEnv(),
[36m(LLMCollector( pid=3151108)[0m         transform=DataLoadingPrimer(primers=Composite(
[36m(LLMCollector( pid=3151108)[0m             tokens: UnboundedDiscrete(
[36m(LLMCollector( pid=3151108)[0m                 shape=torch.Size([16, -1]),
[36m(LLMCollector( pid=3151108)[0m                 space=ContinuousBox(
[36m(LLMCollector( pid=3151108)[0m                     low=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True),
[36m(LLMCollector( pid=3151108)[0m                     high=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True)),
[36m(LLMCollector( pid=3151108)[0m                 device=cpu,
[36m(LLMCollector( pid=3151108)[0m                 dtype=torch.int64,
[36m(LLMCollector( pid=3151108)[0m                 domain=discrete),
[36m(LLMCollector( pid=3151108)[0m             answers: NonTensor(
[36m(LLMCollector( pid=3151108)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151108)[0m                 space=None,
[36m(LLMCollector( pid=3151108)[0m                 device=None,
[36m(LLMCollector( pid=3151108)[0m                 dtype=None,
[36m(LLMCollector( pid=3151108)[0m                 domain=None,
[36m(LLMCollector( pid=3151108)[0m                 example_data=10),
[36m(LLMCollector( pid=3151108)[0m             text: NonTensor(
[36m(LLMCollector( pid=3151108)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151108)[0m                 space=None,
[36m(LLMCollector( pid=3151108)[0m                 device=None,
[36m(LLMCollector( pid=3151108)[0m                 dtype=None,
[36m(LLMCollector( pid=3151108)[0m                 domain=None,
[36m(LLMCollector( pid=3151108)[0m                 example_data=A conversation between User and Assistant. The user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user with the answer. The reasoning process and answer are enclosed within <think></think> and <answer></answer> tags, respectively, i.e., <think>reasoning process here</think> <answer>answer here</answer>. User: Weng earns $12 an hour for babysitting. Yesterday, she just did 50 minutes of babysitting. How much did she earn?. Assistant: <think>),
[36m(LLMCollector( pid=3151108)[0m             device=None,
[36m(LLMCollector( pid=3151108)[0m             shape=torch.Size([16])), dataloader=<torchdata.stateful_dataloader.stateful_dataloader.StatefulDataLoader object at 0x7f8c8837fa10>)),
[36m(LLMCollector( pid=3151108)[0m     policy=<function vllm_generate at 0x7f8cdd1d3ce0>,
[36m(LLMCollector( pid=3151108)[0m     td_out=None,
[36m(LLMCollector( pid=3151108)[0m exploration=random)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(LLMCollector( pid=3151212)[0m /home/felipemello/.conda/envs/torchtune_vllm/lib/python3.11/site-packages/torch/nested/__init__.py:228: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
[36m(LLMCollector( pid=3151212)[0m   return _nested.nested_tensor(
[36m(LLMCollector( pid=3151206)[0m /home/felipemello/.conda/envs/torchtune_vllm/lib/python3.11/site-packages/torch/nested/__init__.py:228: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
[36m(LLMCollector( pid=3151206)[0m   return _nested.nested_tensor(
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 71 zeros in ref_logprobs out of 763326464
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 39 zeros in ref_logprobs out of 2624
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 164]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 314]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 314]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 164]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 164]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:waiting for replay buffer
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 73 zeros in ref_logprobs out of 877582336
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 41 zeros in ref_logprobs out of 3376
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 211]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 361]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 361]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 211]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 211]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(LLMCollector( pid=3151100)[0m /home/felipemello/.conda/envs/torchtune_vllm/lib/python3.11/site-packages/torch/nested/__init__.py:228: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
[36m(LLMCollector( pid=3151100)[0m   return _nested.nested_tensor(
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 80 zeros in ref_logprobs out of 1417259008

[36m(LLMCollector( pid=3151100)[0m                 device=None,
[36m(LLMCollector( pid=3151100)[0m                 dtype=None,
[36m(LLMCollector( pid=3151100)[0m                 domain=None,
[36m(LLMCollector( pid=3151100)[0m                 example_data=A conversation between User and Assistant. The user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user with the answer. The reasoning process and answer are enclosed within <think></think> and <answer></answer> tags, respectively, i.e., <think>reasoning process here</think> <answer>answer here</answer>. User: Weng earns $12 an hour for babysitting. Yesterday, she just did 50 minutes of babysitting. How much did she earn?. Assistant: <think>),
[36m(LLMCollector( pid=3151100)[0m             device=None,
[36m(LLMCollector( pid=3151100)[0m             shape=torch.Size([16])), dataloader=<torchdata.stateful_dataloader.stateful_dataloader.StatefulDataLoader object at 0x7f27c4159490>)),
[36m(LLMCollector( pid=3151100)[0m     policy=<function vllm_generate at 0x7f2819097ce0>,
[36m(LLMCollector( pid=3151100)[0m     td_out=None,
[36m(LLMCollector( pid=3151100)[0m exploration=random)
[36m(LLMCollector( pid=3151108)[0m     env=TransformedEnv(
[36m(LLMCollector( pid=3151108)[0m         env=LLMEnv(),
[36m(LLMCollector( pid=3151108)[0m         transform=DataLoadingPrimer(primers=Composite(
[36m(LLMCollector( pid=3151108)[0m             tokens: UnboundedDiscrete(
[36m(LLMCollector( pid=3151108)[0m                 shape=torch.Size([16, -1]),
[36m(LLMCollector( pid=3151108)[0m                 space=ContinuousBox(
[36m(LLMCollector( pid=3151108)[0m                     low=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True),
[36m(LLMCollector( pid=3151108)[0m                     high=Tensor(shape=torch.Size([16, 1]), device=cpu, dtype=torch.int64, contiguous=True)),
[36m(LLMCollector( pid=3151108)[0m                 device=cpu,
[36m(LLMCollector( pid=3151108)[0m                 dtype=torch.int64,
[36m(LLMCollector( pid=3151108)[0m                 domain=discrete),
[36m(LLMCollector( pid=3151108)[0m             answers: NonTensor(
[36m(LLMCollector( pid=3151108)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151108)[0m                 space=None,
[36m(LLMCollector( pid=3151108)[0m                 device=None,
[36m(LLMCollector( pid=3151108)[0m                 dtype=None,
[36m(LLMCollector( pid=3151108)[0m                 domain=None,
[36m(LLMCollector( pid=3151108)[0m                 example_data=10),
[36m(LLMCollector( pid=3151108)[0m             text: NonTensor(
[36m(LLMCollector( pid=3151108)[0m                 shape=torch.Size([16]),
[36m(LLMCollector( pid=3151108)[0m                 space=None,
[36m(LLMCollector( pid=3151108)[0m                 device=None,
[36m(LLMCollector( pid=3151108)[0m                 dtype=None,
[36m(LLMCollector( pid=3151108)[0m                 domain=None,
[36m(LLMCollector( pid=3151108)[0m                 example_data=A conversation between User and Assistant. The user asks a question, and the Assistant solves it. The assistant first thinks about the reasoning process in the mind and then provides the user with the answer. The reasoning process and answer are enclosed within <think></think> and <answer></answer> tags, respectively, i.e., <think>reasoning process here</think> <answer>answer here</answer>. User: Weng earns $12 an hour for babysitting. Yesterday, she just did 50 minutes of babysitting. How much did she earn?. Assistant: <think>),
[36m(LLMCollector( pid=3151108)[0m             device=None,
[36m(LLMCollector( pid=3151108)[0m             shape=torch.Size([16])), dataloader=<torchdata.stateful_dataloader.stateful_dataloader.StatefulDataLoader object at 0x7f8c8837fa10>)),
[36m(LLMCollector( pid=3151108)[0m     policy=<function vllm_generate at 0x7f8cdd1d3ce0>,
[36m(LLMCollector( pid=3151108)[0m     td_out=None,
[36m(LLMCollector( pid=3151108)[0m exploration=random)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 164, 151936]), responses shape: torch.Size([16, 164])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 164]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 314]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 314]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 164]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 211, 151936]), responses shape: torch.Size([16, 211])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 211]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 361]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 361]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 211]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 433, 151936]), responses shape: torch.Size([16, 433])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 433]), device=cuda:0, dtype=torch.float32, is_shared=True),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 47 zeros in ref_logprobs out of 6928
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 433]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 583]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 583]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 433]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 433]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['5', '5', '5', '5', '5', '5', '5', '5', '5', '5'...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 433])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 583])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 583])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 433])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 433])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 433])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 583])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 583])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 433])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 433])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 65 zeros in ref_logprobs out of 680673280
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 49 zeros in ref_logprobs out of 2192
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 137]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 280]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 280]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 137]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 137]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 60 zeros in ref_logprobs out of 714706944
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 43 zeros in ref_logprobs out of 2416
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 151]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 294]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 294]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 151]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 151]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(LLMCollector( pid=3151108)[0m /home/felipemello/.conda/envs/torchtune_vllm/lib/python3.11/site-packages/torch/nested/__init__.py:228: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
[36m(LLMCollector( pid=3151108)[0m   return _nested.nested_tensor(

[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 583]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 583]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 433]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 137, 151936]), responses shape: torch.Size([16, 137])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 137]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 280]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 280]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 137]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 151, 151936]), responses shape: torch.Size([16, 151])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 151]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 294]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 294]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 151]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 512, 151936]), responses shape: torch.Size([16, 512])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 79 zeros in ref_logprobs out of 1609306112
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 46 zeros in ref_logprobs out of 8192
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 662]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 662]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 77 zeros in ref_logprobs out of 668518400
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 43 zeros in ref_logprobs out of 2544
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 159]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 275]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 275]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 159]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 159]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=0, seq=0: ref_logprob=0.0000, pi_logprob=-15.3949, diff=15.3949, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-15.3949, diff=15.3949, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-15.3949, diff=15.3949, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=4, seq=0: ref_logprob=0.0000, pi_logprob=-15.3949, diff=15.3949, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-15.3949, diff=15.3949, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 15.394853591918945
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.20992982387542725
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 9.177772521972656
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.24623019993305206
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3949], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=1, seq=0: ref_logprob=0.0000, pi_logprob=-15.3949, diff=15.3949, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-15.3949, diff=15.3949, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-15.3949, diff=15.3949, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=7, seq=0: ref_logprob=0.0000, pi_logprob=-15.3949, diff=15.3949, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=8, seq=0: ref_logprob=0.0000, pi_logprob=-15.3949, diff=15.3949, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 15.394853591918945
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.13995322585105896
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 9.177772521972656
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4996580481529236
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([43, 50, 51], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 25, 31, 32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([30, 31, 37], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.208981513977051
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.38675451278686523
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([48, 49], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([48, 49], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 25,  22,  25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 0, 20, 47, 48], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.671113967895508
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5456746220588684
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([36, 37, 39, 43, 44], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([36, 37, 39, 43, 44], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([30, 31, 37], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 36, 42, 43], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([43, 50, 51], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 25, 31, 32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([43, 50, 51], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.208981513977051
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5602671504020691
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([48, 49], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([51], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25,  22,  25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 0, 20, 47, 48], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25,  22,  25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 0, 20, 47, 48], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 7.497435092926025
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6258194446563721
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 15.880082130432129
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7403494715690613
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([48, 49], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.7460739612579346
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4922912120819092
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 7.497435092926025
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.46913960576057434
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 15.880082130432129
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5632291436195374
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 5.575637340545654
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6265397071838379
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 26.12562370300293
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.43891558051109314
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 9.21914291381836
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.12805001437664032
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 7.023882865905762
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5142946243286133
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 26.12562370300293
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.24721930921077728
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 9.21914291381836
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.1030510663986206
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 81 zeros in ref_logprobs out of 736585728
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 47 zeros in ref_logprobs out of 2992
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 187]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 303]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 303]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 187]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 187]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 1
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 187])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 303])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 303])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 187])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 187])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['624', '624', '624', '624', '624', '624', '624',...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 187])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 303])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 303])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 187])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 187])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>

[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 662]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 662]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 159, 151936]), responses shape: torch.Size([16, 159])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 159]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 275]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 275]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 159]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 187, 151936]), responses shape: torch.Size([16, 187])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 187]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 303]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 303]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 187]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 385, 151936]), responses shape: torch.Size([16, 385])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 385]), device=cuda:0, dtype=torch.float32, is_shared=True),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 73 zeros in ref_logprobs out of 1283555328
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 54 zeros in ref_logprobs out of 6160
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 385]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 528]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 528]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 385]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 385]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 2.146564483642578
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.039130084216594696
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 23.410085678100586
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8243675231933594
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 4.516351699829102
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9549610614776611
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  17,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5,  6, 10, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  17,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5,  6, 10, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1466], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([220], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 2.146564483642578
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.04472009465098381
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 5.2501678466796875
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7999204993247986
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  17,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5,  6, 10, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 4.431341171264648
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9123427867889404
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 96 zeros in ref_logprobs out of 1592289280
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 4.516351699829102
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.949150562286377
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 15, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  17,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 10, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 4.439443588256836
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.914914608001709
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 15.208648681640625
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7886862754821777
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2, 6], device='cuda:0'),)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 78 zeros in ref_logprobs out of 8192
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 11], device='cuda:0'),)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 655]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 655]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 15.208648681640625
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8544129133224487
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.52471923828125
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.43434616923332214
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.52471923828125
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5216721296310425
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.161141872406006
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.20383326709270477
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5615208148956299
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.043326061218976974
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1855132579803467
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.029507027938961983
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9248656034469604
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.23209095001220703
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.624300479888916
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.10427787899971008
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3150006532669067
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.04115081951022148
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 58 zeros in ref_logprobs out of 1142558720
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 42 zeros in ref_logprobs out of 5040
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 315]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 470]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 470]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 315]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 315]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 1
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 1
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.6860595941543579
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 88 zeros in ref_logprobs out of 741447680
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 53 zeros in ref_logprobs out of 3024
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 189]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 189]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 189]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 1.4006916750222445
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 2
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2

[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 528]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 528]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 385]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 512, 151936]), responses shape: torch.Size([16, 512])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42', '42'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 655]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 655]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 315, 151936]), responses shape: torch.Size([16, 315])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 315]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 470]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 470]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 315]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(vLLMParameterServer pid=3151482)[0m INFO 04-07 08:41:09 [utils.py:925] Found nccl from library libnccl.so.2
[36m(vLLMParameterServer pid=3151482)[0m INFO 04-07 08:41:09 [pynccl.py:69] vLLM is using nccl==2.21.5
[36m(vLLMParameterServer pid=3151482)[0m NCCL version 2.21.5+cuda12.4
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151108)[0m INFO 04-07 08:41:09 [utils.py:925] Found nccl from library libnccl.so.2
[36m(LLMCollector( pid=3151108)[0m INFO 04-07 08:41:09 [pynccl.py:69] vLLM is using nccl==2.21.5
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 189, 151936]), responses shape: torch.Size([16, 189])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 189]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 189]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(vLLMParameterServer pid=3151482)[0m INFO 04-07 08:41:09 [utils.py:925] Found nccl from library libnccl.so.2
[36m(vLLMParameterServer pid=3151482)[0m INFO 04-07 08:41:09 [pynccl.py:69] vLLM is using nccl==2.21.5
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151212)[0m INFO 04-07 08:41:09 [utils.py:925] Found nccl from library libnccl.so.2
[36m(LLMCollector( pid=3151212)[0m INFO 04-07 08:41:09 [pynccl.py:69] vLLM is using nccl==2.21.5
[36m(vLLMParameterServer pid=3151482)[0m INFO 04-07 08:41:10 [utils.py:925] Found nccl from library libnccl.so.2
[36m(vLLMParameterServer pid=3151482)[0m INFO 04-07 08:41:10 [pynccl.py:69] vLLM is using nccl==2.21.5
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151100)[0m INFO 04-07 08:41:10 [utils.py:925] Found nccl from library libnccl.so.2
[36m(LLMCollector( pid=3151100)[0m INFO 04-07 08:41:10 [pynccl.py:69] vLLM is using nccl==2.21.5
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['35', '35', '35', '35', '35', '35', '35', '35', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 315])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 470])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 470])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 315])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 315])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 315])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 470])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 470])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 315])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 315])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 58 zeros in ref_logprobs out of 1621460992
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 42 zeros in ref_logprobs out of 8192
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-15.3908, diff=15.3908, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=4, seq=0: ref_logprob=0.0000, pi_logprob=-15.3908, diff=15.3908, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=8, seq=0: ref_logprob=0.0000, pi_logprob=-15.3908, diff=15.3908, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=9, seq=0: ref_logprob=0.0000, pi_logprob=-15.3908, diff=15.3908, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=12, seq=0: ref_logprob=0.0000, pi_logprob=-15.3908, diff=15.3908, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 15.390792846679688
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.21396656334400177
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=1
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 35.2022819519043
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6177233457565308
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.3908], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=0, seq=0: ref_logprob=0.0000, pi_logprob=-15.3908, diff=15.3908, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=1, seq=0: ref_logprob=0.0000, pi_logprob=-15.3908, diff=15.3908, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-15.3908, diff=15.3908, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-15.3908, diff=15.3908, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-15.3908, diff=15.3908, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 15.390792846679688
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.2276041954755783
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 10.167173385620117
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5170623660087585
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6871399879455566
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0011872717877849936
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.000267505645752
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7514049410820007
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 25, 32, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([39], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 25, 32, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.37041187286376953
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0007351026288233697
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.6271815299987793
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7738311290740967
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([31, 38], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([31, 38], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([31, 38], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.166646957397461
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0014184139436110854
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 5.762533664703369
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8019624948501587
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6871399879455566
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.002743532182648778
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.000267505645752
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7414433360099792
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 25, 32, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 17, 22, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([39], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 25, 32, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.37041187286376953
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0004914840101264417
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.6271815299987793
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7538071274757385
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([31, 38], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22, 23, 25, 30, 31], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([35], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 20, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.166646957397461
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.001423912006430328
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 5.51170539855957
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7640328407287598
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.7895e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([37], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.21344423294067383
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0009936429560184479
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 13.36564826965332
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.661120593547821
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.7895e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([37], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.1648106575012207
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00032528358860872686
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 13.36564826965332
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6879642605781555
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.00211530365049839
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00012380808766465634
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.950080633163452
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3670455515384674
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.7974493503570557
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.170891672372818
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.2666101455688477
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.06300916522741318
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.00211530365049839
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -6.190404383232817e-05
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.950080633163452
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3673115372657776
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.4035491943359375
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.11994164437055588
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.2666101455688477
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.04746756702661514
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 77 zeros in ref_logprobs out of 731723776
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 44 zeros in ref_logprobs out of 2960
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 185]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 185]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 185]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=1
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=1
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=1
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.

[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(vLLMParameterServer pid=3151482)[0m INFO 04-07 08:41:10 [utils.py:925] Found nccl from library libnccl.so.2
[36m(vLLMParameterServer pid=3151482)[0m INFO 04-07 08:41:10 [pynccl.py:69] vLLM is using nccl==2.21.5
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151206)[0m INFO 04-07 08:41:10 [utils.py:925] Found nccl from library libnccl.so.2
[36m(LLMCollector( pid=3151206)[0m INFO 04-07 08:41:10 [pynccl.py:69] vLLM is using nccl==2.21.5
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 512, 151936]), responses shape: torch.Size([16, 512])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 185, 151936]), responses shape: torch.Size([16, 185])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624', '624'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 185]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 185]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 154, 151936]), responses shape: torch.Size([16, 154])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 154]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 154]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 74 zeros in ref_logprobs out of 731723776
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 40 zeros in ref_logprobs out of 2464
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 154]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=0, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 154]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 154]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 2
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 3
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 2
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['624', '624', '624', '624', '624', '624', '624',...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, 301]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, 301]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.2168750762939453
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.01517229713499546
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 7.566930294036865
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9506478309631348
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9977231025695801
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.005977919325232506
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 8.918280601501465
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9704627990722656
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0240], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.227086067199707
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0012796688824892044
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 7.566930294036865
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9367903470993042
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9977231025695801
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0002048804162768647
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 8.918280601501465
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9882818460464478
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.44042909145355225
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0025361976586282253
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 4.838375091552734
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9321953654289246
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5091567039489746
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.002891628770157695
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 31.33682632446289
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 1.016662836074829
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.2430000305175781
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0020682623144239187
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 7.484720706939697
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8046420812606812
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.12409162521362305
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0028325687162578106
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.2430000305175781
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0037429356016218662
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.2368111610412598
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7456283569335938
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.8725156784057617
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4644209146499634
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.1903972625732422
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0005826854612678289
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8886488676071167
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.16459304094314575
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.007381938397884369
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0016125858528539538
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 9.601140022277832
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.38491904735565186
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.06317293643951416
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9613361358642578
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.15156225860118866
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.8397414684295654
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001039926428347826
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.8397414684295654
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.16238060593605042
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.10067462176084518
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6880377531051636
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.06013469770550728
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -8.4873e-05], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -8.4873e-05], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.23899388313293457
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0006576920277439058
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.148848056793213
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.14830724895000458
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 3
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 3
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.6693195654079318
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.7249099686741829
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 4
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['624', '624', '624', '624', '624', '624', '624',...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, 301]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, 301]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6024227142333984
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.07736199349164963
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.3999521732330322
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8961040377616882
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2803483009338379
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.02848546952009201
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.4651947021484375
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9876459836959839
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0112], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6024227142333984
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.074477419257164
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 6.895550727844238
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9243361353874207
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2803483009338379
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.024886004626750946
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 4.3260674476623535
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 1.009355068206787
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6819967031478882
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.01589794084429741
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6819967031478882
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.016895998269319534
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 14.153365135192871
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9875876307487488
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 14.153365135192871
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 1.0039255619049072
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.1350134313106537
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006953667849302292
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 5.866331577301025
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7816860675811768
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.1259765625
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.010119090788066387
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.2806737422943115
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8164617419242859
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-8.3446e-07, -1.0729e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-8.3446e-07, -1.0729e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-8.3446e-07, -1.0729e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-8.3446e-07, -1.0729e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.31639301776885986
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.005529298912733793
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.4261224269866943
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4845254123210907
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.41440773010253906
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.000788586214184761
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.31639301776885986
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006465116050094366
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 9.029725074768066
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5418533086776733
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8134247064590454
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.2053840458393097
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.41440773010253906
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004837549291551113
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7213150262832642
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.23150590062141418
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.0729e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.0729e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.09567129611968994
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003628881648182869
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.17936372756958
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.18075203895568848
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.19187748432159424
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0012538181617856026
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.11476993560791
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.15424028038978577
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.09567129611968994
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0014076901134103537
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9107223749160767
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.0942118689417839
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -3.5763e-07, -1.5842e-04], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.12502531707286835
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0018036785768344998
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.104788064956665
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.028386645019054413
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 4
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 5
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 4
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and

[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['624', '624', '624', '624', '624', '624', '624',...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, 301]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, 301]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 185])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.5210888385772705
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.047162365168333054
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 14.867828369140625
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 1.0184599161148071
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.45583534240722656
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.019612165167927742
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.8387184143066406
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.968222975730896
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.039682388305664
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.018542641773819923
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 6.057819366455078
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8836026191711426
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1,  2, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.17107069492340088
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00790648814290762
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 4.908505439758301
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6807650327682495
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.4307546615600586
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0004951809532940388
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 8.958897590637207
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4405391216278076
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0042], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.5210888385772705
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.04460754245519638
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 14.867828369140625
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 1.0143458843231201
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.48801207542419434
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.013386244885623455
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.2756102085113525
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 1.0040109157562256
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.039682388305664
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.01594856195151806
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 29.96000862121582
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8880857229232788
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.11837852001190186
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006154179573059082
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 4.908505439758301
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7045509219169617
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1595821380615234
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.004292045254260302
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.138094186782837
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.20605115592479706
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.4307546615600586
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0001589353196322918
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.049865484237671
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4352927803993225
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.22396326065063477
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0008485866710543633
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.471482753753662
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.08832281082868576
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9999942779541016
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0012715049088001251
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.109785556793213
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.12714055180549622
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07, -4.7684e-07, -5.1497e-05], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.17407405376434326
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0005015177885070443
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.763105869293213
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.060853566974401474
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2761240005493164
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0011840218212455511
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9439064264297485
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.08955195546150208
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -4.7684e-07, -5.1497e-05], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2761240005493164
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0011840217048302293
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9439064264297485
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.05960078909993172
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 79 zeros in ref_logprobs out of 1721131008
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 47 zeros in ref_logprobs out of 8192
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=1, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 5
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=2
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 5
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=2
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=2
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 76 zeros in ref_logprobs out of 1621460992
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 59 zeros in ref_logprobs out of 8192
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=1, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.7739470982924104
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=2
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 132 zeros in ref_logprobs out of 1602013184
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 99 zeros in ref_logprobs out of 8192
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=1, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 659]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 659]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 1.2771693244576454
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 6
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 512])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 667])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 667])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 512])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 512])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>

[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 512, 151936]), responses shape: torch.Size([16, 512])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=1, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 512, 151936]), responses shape: torch.Size([16, 512])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=1, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 512, 151936]), responses shape: torch.Size([16, 512])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=1, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 659]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 659]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['35', '35', '35', '35', '35', '35', '35', '35', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 512])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 667])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 667])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 512])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 512])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 103 zeros in ref_logprobs out of 1621460992
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 83 zeros in ref_logprobs out of 8192
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=1, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 79 zeros in ref_logprobs out of 624760832
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 47 zeros in ref_logprobs out of 1760
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 110]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=2, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 257]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 257]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 110]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 110]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=3
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([44, 53], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([53], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([27, 28, 35], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([27, 28, 35], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([53], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([53], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([48, 55], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=1, seq=0: ref_logprob=-6.6937, pi_logprob=-11.2264, diff=4.5327, token_id=1519, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=17, seq=0: ref_logprob=-6.6937, pi_logprob=-11.2264, diff=4.5327, token_id=1519, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=26, seq=0: ref_logprob=-6.6937, pi_logprob=-11.2264, diff=4.5327, token_id=1519, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 4.532675743103027
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.006500464864075184
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 3.7492499351501465
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.18193989992141724
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 104.91045379638672
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9902259111404419
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -1.1921e-07, -7.8678e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21, 37, 38], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([53], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([62, 63], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -7.8678e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([48, 49, 60, 61], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([53], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([27, 28, 35], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 2.4996862411499023
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003759725484997034
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 2.015554666519165
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: -0.10480205714702606
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 104.91045379638672
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 1.1636847257614136
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([41, 42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([39], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([41, 42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07,  0.0000e+00, -1.7881e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     23,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([37, 42, 45, 46], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00, -4.1723e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 25, 34, 35], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([41, 42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([41, 42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -8.3446e-07, -3.5763e-07,  0.0000e+00,
[36m(PyTorchActorModel pid=3151076)[0m          0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  19,  23,  29,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([27, 28, 37, 38, 45, 47], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00, -4.1723e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 25, 34, 35], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -8.3446e-07, -3.5763e-07,  0.0000e+00,
[36m(PyTorchActorModel pid=3151119)[0m          0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  19,  23,  29,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([27, 28, 37, 38, 45, 47], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([62], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([62], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -1.1921e-07, -7.8678e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21, 37, 38], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([62], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([39], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 20, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07,  0.0000e+00, -1.7881e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     23,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([37, 42, 45, 46], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -1.1921e-07, -7.8678e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21, 37, 38], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -5.9605e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  19], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([56, 57, 63], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -5.9605e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  19], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([56, 57, 63], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([41, 42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -8.3446e-07, -3.5763e-07,  0.0000e+00,
[36m(PyTorchActorModel pid=3151119)[0m          0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  19,  23,  29,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([27, 28, 37, 38, 45, 47], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([23, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([60, 61], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8969631195068359
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003281587501987815
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 3.7492499351501465
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.18193989992141724
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 9.63956069946289
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8190267086029053
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00, -5.9605e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([43, 44, 46, 51, 52], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([39], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.4133288860321045
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00022047339007258415
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 2.015554666519165
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: -0.10480205714702606
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 9.63956069946289
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8712772727012634
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -2.7537e-05], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([28, 36, 37], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -1.7881e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([25, 33, 34], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([44, 45, 61], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([44, 45, 61], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([44, 45, 61], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -3.3379e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([36, 38, 50, 51], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -2.7537e-05], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([28, 36, 37], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -3.3379e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([36, 38, 50, 51], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1152721643447876
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.001945100026205182
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 3.7492499351501465
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.18193989992141724
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.811727285385132
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.470222145318985
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22, 58, 59], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22, 58, 59], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22, 58, 59], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -2.0266e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 22, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 4, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.780609130859375
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 2.8470647521317005e-05
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 3.7492499351501465
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.18193989992141724
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.2612600326538086
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3213217854499817
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -5.3644e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1, 46, 47], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 25, 25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13, 16, 58], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 25, 25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13, 16, 58], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 25, 25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13, 16, 58], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -5.3644e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1, 46, 47], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([57], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -5.3644e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1, 46, 47], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -5.3644e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1, 46, 47], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([57], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8685591220855713
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -3.345543518662453e-05
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 3.7492499351501465
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.18193989992141724
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.0070250034332275
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.276354044675827
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([39, 40], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([39, 40], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.5249075889587402
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0024663303047418594
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 3.7492499351501465
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.18193989992141724
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.678776979446411
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.18568846583366394
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([44, 45, 61], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([34, 41, 43], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -1.7881e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.5497e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([52, 53], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -1.7881e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([34, 41, 43], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -2.7537e-05], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([28, 36, 37], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -1.7881e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([44, 45, 61], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=28, seq=1: ref_logprob=-0.3140, pi_logprob=-4.7587, diff=4.4447, token_id=25, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=28, seq=18: ref_logprob=-9.0001, pi_logprob=-17.0000, diff=7.9999, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 7.999876022338867
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.000784627627581358
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 2.015554666519165
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: -0.10480205714702606
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.4472129344940186
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4273568093776703
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 25, 366,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22, 58, 59], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([35, 42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 25, 366,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22, 58, 59], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.5114622116088867
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.004669218324124813
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 2.015554666519165
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: -0.10480205714702606
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 5.936079025268555
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.2724818289279938
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 25, 25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 16, 58], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -5.3644e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1, 46, 47], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([40, 41], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([57], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([40, 41], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([63], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 25, 25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 16, 58], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9836697578430176
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0018512182869017124
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 2.015554666519165
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: -0.10480205714702606
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.3093113899230957
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.20638853311538696
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 25, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([39, 40], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=23, seq=9: ref_logprob=-10.1141, pi_logprob=-13.2833, diff=3.1693, token_id=83239, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 3.169255256652832
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0002581172448117286
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 2.015554666519165
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: -0.10480205714702606
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.678776979446411
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.18524107336997986
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29, 25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29, 25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.3028433322906494
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.005404682829976082
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 2.015554666519165
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: -0.10480205714702606
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8829753398895264
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.18411478400230408
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([31, 32, 38, 40], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.35976099967956543
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001321832649409771
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 3.7492499351501465
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.18193989992141724
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8829753398895264
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.18851086497306824
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366, 220,  20,  19,  15,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([31, 32, 44, 45, 46, 47, 50], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00,
[36m(PyTorchActorModel pid=3151076)[0m          0.0000e+00,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 20, 366,  16,  18,  20,  29,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 16, 20, 21, 22, 26, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([49], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366, 220,  20,  19,  15,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([31, 32, 44, 45, 46, 47, 50], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366, 220,  20,  19,  15,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([31, 32, 44, 45, 46, 47, 50], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366, 220,  20,  19,  15,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([31, 32, 44, 45, 46, 47, 50], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366, 220,  20,  19,  15,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([31, 32, 44, 45, 46, 47, 50], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3169369697570801
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001321502961218357
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 2.015554666519165
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: -0.10480205714702606
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9883662462234497
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.18601897358894348
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00,
[36m(PyTorchActorModel pid=3151119)[0m          0.0000e+00,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 20, 366,  16,  18,  20,  29,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([10, 16, 20, 21, 22, 26, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00,
[36m(PyTorchActorModel pid=3151119)[0m          0.0000e+00,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 20, 366,  16,  18,  20,  29,  25], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([10, 16, 20, 21, 22, 26, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3169369697570801
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003963672090321779
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 3.7492499351501465
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.18193989992141724
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9883662462234497
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.18755632638931274
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=3
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=3
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 101 zeros in ref_logprobs out of 807084032
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 69 zeros in ref_logprobs out of 2176
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 136]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=2, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 332]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 332]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 136]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 136]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=3
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 6
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 7
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 6
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['48', '48', '48', '48', '48', '48', '48', '48', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 332])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 332])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and

[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 512, 151936]), responses shape: torch.Size([16, 512])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=1, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 667]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 110, 151936]), responses shape: torch.Size([16, 110])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 110]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=2, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 257]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 257]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 110]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 136, 151936]), responses shape: torch.Size([16, 136])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 136]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=2, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 332]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 332]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 136]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 332])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 332])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=3, self.version=3, self.vllm_weight_versions[worker_id]=3
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8771672248840332
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.027569521218538284
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.755429267883301
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9702870845794678
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1,  2,  4, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7291795015335083
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.01766318827867508
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7565375566482544
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9147735238075256
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  17,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4,  8, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([22502], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.0265583992004395
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.007729190401732922
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.010136842727661
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9472853541374207
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6040126085281372
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0005714481230825186
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5271943807601929
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9525834321975708
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00, -3.5763e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7,  9, 14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 3, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2,  4, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.42154645919799805
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.009941299445927143
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5421808958053589
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8632491827011108
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 3, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([4, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -4.7684e-07,  0.0000e+00,
[36m(PyTorchActorModel pid=3151119)[0m         -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 2,  3,  5,  7, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 3, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9241218566894531
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.017642147839069366
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.3033947944641113
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8455026745796204
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  17,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4,  8, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6040126085281372
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.001909363199956715
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3408528566360474
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9247515797615051
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2746858596801758
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001607598620466888
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 3, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.23446357250213623
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.005310053937137127
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.230281352996826
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8803552985191345
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5037496089935303
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7037049531936646
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2746858596801758
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0019278929103165865
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.368701457977295
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.688387393951416
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 2,  3, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2,  3, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7491474151611328
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.000781348324380815
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6420152187347412
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5517206788063049
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2,  3, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.13262957334518433
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0036705180536955595
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6420152187347412
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 2,  3,  5, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4405876398086548
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 2,  3,  5, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2,  3,  5, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0257246270775795
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0004693004011642188
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.358029842376709
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.1930686980485916
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.13335943222045898
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004588725510984659
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.358029842376709
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3608406186103821
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2939488887786865
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.11517377197742462
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00, -4.7684e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00, -4.7684e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3051796555519104
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.001423846697434783
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3135219812393188
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.19794961810112
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 74 zeros in ref_logprobs out of 617467904
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 42 zeros in ref_logprobs out of 1712
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 107]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=2, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 254]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 254]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 107]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 107]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 7
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 7
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.7411007694900036
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 74 zeros in ref_logprobs out of 994269184
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 42 zeros in ref_logprobs out of 3360
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 210]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=2, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 409]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 409]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 210]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 210]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 1.0579622890800238
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 8
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['48', '48', '48', '48', '48', '48', '48', '48', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 332])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 332])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=4
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=4
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 332])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 332])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 136])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.3466176986694336
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0041], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.3466176986694336
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.01734733209013939
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 4.678983211517334
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9610846042633057
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.010972226038575172
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 4.678983211517334
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9707200527191162
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00, -1.1921e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7,  9, 14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00, -1.1921e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6,  7,  9, 14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5700325965881348
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.002650776645168662
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.7434351444244385
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8983426690101624
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00, -1.1921e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6,  8, 14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8754428625106812
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003380940994247794
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.464287281036377
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.912443220615387
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  17,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4,  8, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  17,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4,  8, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4838860034942627
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0075692711398005486
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.942042350769043
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9566513299942017
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  17,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4,  8, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -4.7684e-07,  0.0000e+00,
[36m(PyTorchActorModel pid=3151076)[0m          0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2,  3,  5,  7, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -4.7684e-07,  0.0000e+00,
[36m(PyTorchActorModel pid=3151076)[0m          0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2,  3,  5,  7, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  17,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4,  8, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5161901712417603
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003028679173439741
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.71834397315979
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9215989708900452
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 3, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9169340133666992
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003932640887796879
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7108423709869385
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8735941052436829
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-8.3446e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-8.3446e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.25418615341186523
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0019632235635071993
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -4.7684e-07,  0.0000e+00,
[36m(PyTorchActorModel pid=3151119)[0m          0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 2,  3,  5,  7, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([4, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.0201871395111084
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7438547611236572
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 3, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2,  3, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8118410110473633
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0010457421885803342
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4688808917999268
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6821714043617249
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -4.7684e-07,  0.0000e+00,
[36m(PyTorchActorModel pid=3151119)[0m          0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     21,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 2,  3,  5,  7, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9169340133666992
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4305e-06, -4.7683e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0013486964162439108
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7108423709869385
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7571229934692383
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4305e-06, -4.7683e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-8.3446e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2815053462982178
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0016657058149576187
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.0201871395111084
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5538177490234375
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24667739868164062
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004908447153866291
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.240096092224121
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5355699062347412
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00, -1.1921e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5178788900375366
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0011900283861905336
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1258749961853027
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.27518948912620544
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8118410110473633
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.002245240146294236
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4964643716812134
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.48378264904022217
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4305e-06, -4.7683e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.0266e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.0266e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24667739868164062
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0031459403689950705
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.240096092224121
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.2984619736671448
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00, -1.1921e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5178788900375366
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0011903943959623575
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0856128931045532
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.09827154129743576

[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 107, 151936]), responses shape: torch.Size([16, 107])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48', '48'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 107]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=2, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 254]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 254]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 107]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 210, 151936]), responses shape: torch.Size([16, 210])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 210]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=2, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 409]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 409]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 210]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 155, 151936]), responses shape: torch.Size([16, 155])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 155]), device=cuda:0, dtype=torch.float32, is_shared=True),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 69 zeros in ref_logprobs out of 860565504
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 37 zeros in ref_logprobs out of 2480
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 155]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=3, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 354]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 354]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 155]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 155]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=4
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 91 zeros in ref_logprobs out of 1042888704
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 59 zeros in ref_logprobs out of 4352
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 272]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=3, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 429]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 429]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 272]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 272]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 8
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 9
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 8
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['990', '990', '990', '990', '990', '990', '990',...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 272])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 429])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 429])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 272])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 272])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 272])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 429])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 429])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 272])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 272])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=1, seq=0: ref_logprob=0.0000, pi_logprob=-13.3756, diff=13.3756, token_id=14276, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-13.3756, diff=13.3756, token_id=14276, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=4, seq=0: ref_logprob=0.0000, pi_logprob=-13.3756, diff=13.3756, token_id=14276, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=7, seq=0: ref_logprob=0.0000, pi_logprob=-13.3756, diff=13.3756, token_id=14276, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=11, seq=0: ref_logprob=0.0000, pi_logprob=-13.3756, diff=13.3756, token_id=14276, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 13.375577926635742
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.10742220282554626
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.4482555389404297
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8889035582542419
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-13.3756], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([14276], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=4, seq=0: ref_logprob=0.0000, pi_logprob=-13.3756, diff=13.3756, token_id=14276, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=-1.3388, pi_logprob=-4.4794, diff=3.1406, token_id=333, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=7, seq=0: ref_logprob=0.0000, pi_logprob=-13.3756, diff=13.3756, token_id=14276, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=8, seq=0: ref_logprob=-1.3388, pi_logprob=-4.4794, diff=3.1406, token_id=333, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=10, seq=0: ref_logprob=0.0000, pi_logprob=-13.3756, diff=13.3756, token_id=14276, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 13.375577926635742
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.12964949011802673
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.4482555389404297
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8694503307342529
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.058089017868042
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.04638732224702835
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6529208421707153
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9885731935501099
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.747546911239624
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0035526712890714407
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3174954652786255
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9798884987831116
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.058089017868042
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.01691906526684761
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6529208421707153
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9864349365234375
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -4.2915e-06, -2.3842e-07,  0.0000e+00, -9.5367e-07,
[36m(PyTorchActorModel pid=3151076)[0m         -4.3180e-04, -3.6955e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     16,     20,     20,     29, 151643],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19, 20, 24, 25, 26, 29, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5591551065444946
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.017730604857206345
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4089096784591675
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9818852543830872
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5763e-07, -7.1526e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     17, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1,  7, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00, -4.3168e-04,
[36m(PyTorchActorModel pid=3151119)[0m         -5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 2,  3,  7,  8, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6326181888580322
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006370418705046177
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5366137027740479
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9181862473487854
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.1526e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.3719e-04, -1.7881e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5763e-07,  0.0000e+00, -1.0022e-01, -3.6477e-05],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18, 27, 31, 32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1458e-06, -2.3842e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 15,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 32, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.1526e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -7.1526e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([26, 27, 29], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5763e-07, -7.1526e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     17, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  7, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([26, 27, 29], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([26, 27, 29], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -7.1526e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -7.1526e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6411504745483398
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.008752040565013885
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8326621055603027
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8285481333732605
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1458e-06, -2.3842e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 15,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 32, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5763e-07,  0.0000e+00, -1.0022e-01, -3.6477e-05],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18, 27, 31, 32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.3719e-04, -1.7881e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5763e-07,  0.0000e+00, -1.0022e-01, -3.6477e-05],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18, 27, 31, 32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5235748291015625
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.009314716793596745
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5526458024978638
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7033730745315552
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.5259e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.5259e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.1458e-06, -2.3842e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 15,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 32, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.3719e-04, -1.7881e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.5259e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3869052529335022
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006045303773134947
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5349962711334229
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6628528237342834
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00, -1.1921e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  15,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 19, 20, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4741075038909912
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00042828908772207797
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6175144910812378
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4824424684047699
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5934969186782837
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.001591577660292387
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7314702272415161
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3427860140800476
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.3113e-06, -5.2383e-03], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.014911379665136337
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00027458209660835564
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.198872447013855
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.09247823059558868
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -7.1526e-07, -1.4305e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([5, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00, -1.1921e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 19, 20, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -7.1526e-07, -1.4305e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([5, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4741075038909912
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0010081706568598747
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.6774308681488037
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4408363401889801
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7314702272415161
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.26354357600212097
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.198872447013855
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.07229340076446533
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 92 zeros in ref_logprobs out of 831393792
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 60 zeros in ref_logprobs out of 2960
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 185]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=3, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 342]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 342]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 185]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 185]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=2, self.version=4, self.vllm_weight_versions[worker_id]=4

[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=3, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 354]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 354]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 155]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 272, 151936]), responses shape: torch.Size([16, 272])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 272]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=3, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 429]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 429]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 272]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 185, 151936]), responses shape: torch.Size([16, 185])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 185]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=3, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 342]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 342]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 185]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 512, 151936]), responses shape: torch.Size([16, 512])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 140 zeros in ref_logprobs out of 1721131008
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 108 zeros in ref_logprobs out of 8192
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=3, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=4
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 116 zeros in ref_logprobs out of 1721131008
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 84 zeros in ref_logprobs out of 8192
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=3, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 9
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 9
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 69 zeros in ref_logprobs out of 921339904
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 37 zeros in ref_logprobs out of 2880
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 180]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 379]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 379]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 180]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 180]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=3, self.version=4, self.vllm_weight_versions[worker_id]=4
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.7017599754035473
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=0, self.version=4, self.vllm_weight_versions[worker_id]=4
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 75 zeros in ref_logprobs out of 1341898752
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 43 zeros in ref_logprobs out of 5840
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 365]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 552]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 552]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 365]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 365]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.8098079282790422
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 10
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['5', '5', '5', '5', '5', '5', '5', '5', '5', '5'...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 365])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 552])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 552])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 365])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 365])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>

[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=3, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 512, 151936]), responses shape: torch.Size([16, 512])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=3, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 708]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 512]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 180, 151936]), responses shape: torch.Size([16, 180])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 180]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 379]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 379]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 180]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 365, 151936]), responses shape: torch.Size([16, 365])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 365]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 552]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 552]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 365]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 365])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 552])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 552])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 365])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 365])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 69 zeros in ref_logprobs out of 1327312896
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 37 zeros in ref_logprobs out of 5744
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 359]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 546]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 546]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 359]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 359]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 68 zeros in ref_logprobs out of 853272576
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 36 zeros in ref_logprobs out of 2432
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 152]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 351]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 351]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 152]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 152]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1480], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([4412], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.0580792427062988
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.012685625813901424
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4995089769363403
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6634300351142883
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([34, 35, 41], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([44, 45], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([44, 45], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07, -1.0848e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([40, 41], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7661107778549194
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00879825372248888
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4235156774520874
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8251253366470337
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1918646097183228
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006522347219288349
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4643336534500122
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8528258204460144
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-06, -7.1526e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13, 14, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7412e-01, -2.9087e-05,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7412e-01, -2.9087e-05,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-06, -7.1526e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13, 14, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0007,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.0414433479309082
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0037311192136257887
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5014188289642334
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7378999590873718
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([4412], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6203], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([279], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.0580792427062988
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006546772085130215
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4995089769363403
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6802853941917419
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([44, 45], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([34, 35, 41], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07, -1.0848e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([40, 41], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([44, 45], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7807483673095703
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.009377868846058846
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.0089640617370605
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8364531397819519
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([39, 40], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1918646097183228
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.007530496455729008
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4643336534500122
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8559151887893677
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5763e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([33, 34, 40], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.0975172519683838
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.002035283949226141
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.1384189128875732
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6832674145698547
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16, 17, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7920365333557129
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0029827766120433807
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6213791370391846
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5556870698928833
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-06, -7.1526e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 14, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7412e-01, -2.9087e-05,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.0414433479309082
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0006661076913587749
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5014188289642334
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7455240488052368
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5763e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([33, 34, 40], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.0975172519683838
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0016653595957905054
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.622819423675537
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6606560945510864
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3421173095703125
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0006158902542665601
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2658278942108154
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.25986969470977783
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([41], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.09607338905334473
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0008582787122577429
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5329585075378418
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.08247119188308716
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([16, 17, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0381], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24060551822185516
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0038986511062830687
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6213791370391846
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4733486771583557
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3421173095703125
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0004098813224118203
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.408553957939148
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.251564621925354
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2754480838775635
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.05136439949274063
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=5
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 96 zeros in ref_logprobs out of 872720384
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 64 zeros in ref_logprobs out of 3232
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 202]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 359]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 359]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 202]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 202]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=5
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 82 zeros in ref_logprobs out of 661225472
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 66 zeros in ref_logprobs out of 2288
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 143]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 272]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 272]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 143]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 143]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=5
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 10
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 11
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 10

[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 359, 151936]), responses shape: torch.Size([16, 359])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 359]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 546]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 546]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 359]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 152, 151936]), responses shape: torch.Size([16, 152])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41', '41'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 152]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 351]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 351]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 152]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 202, 151936]), responses shape: torch.Size([16, 202])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 202]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 359]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 359]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 202]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 143, 151936]), responses shape: torch.Size([16, 143])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 143]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 272]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 272]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 143]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 202])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 359])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 359])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 202])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 202])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['990', '990', '990', '990', '990', '990', '990',...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 202])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 359])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 359])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 202])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 202])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 81 zeros in ref_logprobs out of 862996480
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 65 zeros in ref_logprobs out of 3616
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 226]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 355]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 355]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 226]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 226]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1419180631637573
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.021488482132554054
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6990563869476318
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8903743028640747
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9556171894073486
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.02128126658499241
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8147568702697754
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9801096320152283
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07, -1.1921e-07, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([10, 11, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7666457295417786
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.013196311891078949
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8682401180267334
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9636826515197754
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.9312e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1419180631637573
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.06227393448352814
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.4061176776885986
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8604605793952942
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -8.0458e-04, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  18], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -8.0458e-04, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  18], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9556171894073486
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.020909223705530167
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8147568702697754
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9697943925857544
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -8.0458e-04, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  18], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -4.5656e-05, -4.7684e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([10, 11, 16, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4484119415283203
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.02072213776409626
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6266251802444458
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9627009630203247
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07, -1.1921e-07, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 11, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7666457295417786
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.02100445330142975
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8682401180267334
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.948327898979187
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.0729e-05, -8.3446e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.0729e-05, -8.3446e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -8.0458e-04, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  18], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 19, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -4.5656e-05, -4.7684e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 11, 16, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -3.5763e-07, -3.1815e-03,
[36m(PyTorchActorModel pid=3151119)[0m         -1.1921e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 20, 21, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -4.7684e-07, -7.1526e-07, -7.1107e-04],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  18,  20,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15, 16, 21, 22, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.0729e-05, -8.3446e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -4.5656e-05, -4.7684e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 11, 16, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.29839223623275757
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.009162831120193005
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6266251802444458
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9563108086585999
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.0729e-05, -8.3446e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7551937103271484
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004222000949084759
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5357860326766968
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8393712043762207
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-8.3446e-07, -4.8647e-02], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -3.5763e-07, -3.1815e-03,
[36m(PyTorchActorModel pid=3151076)[0m         -1.1921e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 20, 21, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -3.5763e-07, -3.1815e-03,
[36m(PyTorchActorModel pid=3151076)[0m         -1.1921e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 20, 21, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3184235095977783
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.009495038539171219
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5357860326766968
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8574963212013245
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.1260e-06, -2.4554e-04, -1.1921e-07, -2.0418e-04, -7.7486e-06],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     16,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1,  2,  6, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07, -2.1458e-06, -8.2254e-06, -1.4305e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -5.9605e-07, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 11, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -5.9605e-07, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 11, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.921728253364563
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0029937205836176872
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3224632740020752
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4661463499069214
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-8.3446e-07, -4.8647e-02], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-8.3446e-07, -4.8647e-02], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07, -2.1458e-06, -8.2254e-06, -1.4305e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=25: ref_logprob=-0.0309, pi_logprob=-3.9469, diff=3.9160, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=28, seq=25: ref_logprob=-0.0309, pi_logprob=-3.9469, diff=3.9160, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 3.916034698486328
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.008580106310546398
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3284564018249512
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.46208393573760986
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.0531e-06, -8.3446e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6, 11, 14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.0531e-06, -8.3446e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6, 11, 14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.31014180183410645
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0014079789398238063
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3883973360061646
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.12804028391838074
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6, 14, 18, 19], device='cuda:0'),)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=5
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.0531e-06, -8.3446e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6, 11, 14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.0531e-06, -8.3446e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6, 11, 14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.0531e-06, -8.3446e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6, 11, 14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.009126055985689163
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004253106191754341
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.421733021736145
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.15686628222465515
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6, 14, 18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6, 14, 18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.016170866787433624
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0005810568109154701
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.041202425956726
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.11508546024560928
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1192859411239624
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.060507144778966904
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=3, self.version=5, self.vllm_weight_versions[worker_id]=5
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 11
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=1, self.version=5, self.vllm_weight_versions[worker_id]=5
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 11
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.6834568195044994
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 78 zeros in ref_logprobs out of 678242304
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 61 zeros in ref_logprobs out of 1952
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 122]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 279]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 279]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 122]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 122]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.9641798920929432
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 12
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['85', '85', '85', '85', '85', '85', '85', '85', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [4, 4, 4, 4, 4, 4, 5, 4, 5, 5, 5, 4, 4, 5, 4, 4, 5...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 226])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 355])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 355])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 226])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 226])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>

[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 226, 151936]), responses shape: torch.Size([16, 226])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 226]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=4, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 355]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 355]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 226]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 122, 151936]), responses shape: torch.Size([16, 122])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 122]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 279]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 279]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 122]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 226])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 355])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 355])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 226])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 226])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 114 zeros in ref_logprobs out of 741447680
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 82 zeros in ref_logprobs out of 2368
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 148]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 148]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 148]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7482953071594238
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.005450299941003323
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4328123331069946
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8673498034477234
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5214406251907349
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006669906899333
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4140938520431519
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8161587119102478
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -4.7684e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 19, 22, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8014e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7482953071594238
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.008387980051338673
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4328123331069946
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8612818717956543
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.42944884300231934
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.014409533701837063
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2968623638153076
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8351218104362488
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -7.1526e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4,  8, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -9.5367e-07, -4.7684e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 16, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -9.5367e-07, -4.7684e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11, 12, 16, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.9802e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2, 5, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -4.7684e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 17, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -4.7684e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  20,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 12, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2, 5, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -4.7684e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 17, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -4.7684e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 17, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5733730792999268
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.005057116970419884
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7295362949371338
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8517745137214661
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -4.7684e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  20,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 12, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -2.3842e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6,  7, 11, 14, 15], device='cuda:0'),)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 69 zeros in ref_logprobs out of 734154752
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.9802e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -4.7684e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 19, 22, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.23513436317443848
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.009975682944059372
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7295362949371338
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7819582223892212
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 53 zeros in ref_logprobs out of 2320
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 145]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 302]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 302]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 145]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 145]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.6689e-06, -4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 4, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.6358e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.6689e-06, -4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 4, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.21032381057739258
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0030198763124644756
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.41139554977417
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5406084656715393
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=2: ref_logprob=-0.0002, pi_logprob=-3.6584, diff=3.6582, token_id=366, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=29, seq=2: ref_logprob=-0.0002, pi_logprob=-3.6584, diff=3.6582, token_id=366, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 3.6582210063934326
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.008003417402505875
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6879305839538574
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5598875880241394
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24960720539093018
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0011414369801059365
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6340346336364746
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5259090662002563
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=6
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 14, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.6358e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 14, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 14, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9409611225128174
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.004579640459269285
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.41139554977417
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6155017018318176
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6879305839538574
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5019488334655762
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6340346336364746
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.46375569701194763
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.382948637008667
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.35464733839035034
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0841879844665527
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.12054990231990814
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.16358238458633423
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.007278077304363251
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.382948637008667
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3429834544658661
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.06988847255706787
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0011255793506279588
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0541006326675415
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.20228245854377747
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=6
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 72 zeros in ref_logprobs out of 1186316288
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 40 zeros in ref_logprobs out of 4816
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 488]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 488]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 12
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 13
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 12
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 488])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 488])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3

[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 148, 151936]), responses shape: torch.Size([16, 148])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990', '990'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 148]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 148]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 145, 151936]), responses shape: torch.Size([16, 145])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 145]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 302]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 302]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 145]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 301, 151936]), responses shape: torch.Size([16, 301])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 488]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 488]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 301]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 198, 151936]), responses shape: torch.Size([16, 198])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 93 zeros in ref_logprobs out of 773050368
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 61 zeros in ref_logprobs out of 3168
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 198]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 318]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 318]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 198]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 198]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['5', '5', '5', '5', '5', '5', '5', '5', '5', '5'...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 488])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 488])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 301])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=6
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=2, self.version=6, self.vllm_weight_versions[worker_id]=6
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 81 zeros in ref_logprobs out of 979683328
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 49 zeros in ref_logprobs out of 3456
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 216]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 403]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 403]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 216]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 216]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=1, seq=0: ref_logprob=0.0000, pi_logprob=-9.7205, diff=9.7205, token_id=10435, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-9.7205, diff=9.7205, token_id=10435, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.7205], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10435], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-9.7205, diff=9.7205, token_id=10435, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=9, seq=0: ref_logprob=0.0000, pi_logprob=-9.7205, diff=9.7205, token_id=10435, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-9.7205, diff=9.7205, token_id=10435, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=6, seq=0: ref_logprob=0.0000, pi_logprob=-9.7205, diff=9.7205, token_id=10435, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=7, seq=0: ref_logprob=0.0000, pi_logprob=-9.7205, diff=9.7205, token_id=10435, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 9.720541000366211
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.12119556963443756
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.7034568786621094
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6349272727966309
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=11, seq=0: ref_logprob=0.0000, pi_logprob=-9.7205, diff=9.7205, token_id=10435, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=14, seq=0: ref_logprob=0.0000, pi_logprob=-9.7205, diff=9.7205, token_id=10435, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=15, seq=0: ref_logprob=0.0000, pi_logprob=-9.7205, diff=9.7205, token_id=10435, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 9.720541000366211
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.052251577377319336
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.7034568786621094
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8163029551506042
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9415011405944824
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004257465712726116
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7148733139038086
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7892133593559265
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([29, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3854386806488037
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004498515278100967
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5040500164031982
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8475663065910339
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -5.3644e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9415011405944824
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.008455885574221611
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7148733139038086
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8925186991691589
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([29, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([29, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([29, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([4412], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([29, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5631921291351318
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.01537329237908125
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8276119232177734
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9138431549072266
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -5.3644e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([29, 37], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23, 24, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5890798568725586
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003632154082879424
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5253981351852417
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8314162492752075
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([16, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([23, 24, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([23, 24, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([28, 34], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 15, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([28, 34], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([28, 34], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.27279847860336304
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0003655030741356313
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.6599490642547607
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7861966490745544
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([16, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.5218e-05, -5.9605e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 16, 26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 15, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.1458e-06,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([10, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24852526187896729
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0016750252107158303
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7611360549926758
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6182958483695984
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([29, 37], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([16, 22], device='cuda:0'),)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -1.3113e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.40132689476013184
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0004277464176993817
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.289429783821106
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.23584020137786865
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([29, 37], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8338611125946045
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00478177098557353
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5253981351852417
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.736984372138977
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2968e-03, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.18283283710479736
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0009290665620937943
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.270225167274475
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.10576625913381577
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=6
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2926498055458069
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003442068351432681
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.6599490642547607
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5148923397064209
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.0729e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24852526187896729
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0016451600240543485
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7611360549926758
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.47422027587890625
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -1.3113e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5,  6, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -1.3113e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5,  6, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.40778112411499023
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 5.64549736736808e-05
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.289429783821106
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.21935459971427917
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2968e-03, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.18283283710479736
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0009290665620937943
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.270225167274475
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.06470070779323578
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 90 zeros in ref_logprobs out of 517797888
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 74 zeros in ref_logprobs out of 1344
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 84]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 213]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 213]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 84]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 84]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=0, self.version=6, self.vllm_weight_versions[worker_id]=6
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 86 zeros in ref_logprobs out of 702552064
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 54 zeros in ref_logprobs out of 2704
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 169]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 169]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 169]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 13
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 13
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.6624940717592835
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2

[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 198]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 318]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 318]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 198]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 216, 151936]), responses shape: torch.Size([16, 216])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 216]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=5, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 403]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 403]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 216]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 84, 151936]), responses shape: torch.Size([16, 84])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 84]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 213]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 213]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 84]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 169, 151936]), responses shape: torch.Size([16, 169])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 169]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 169]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 142, 151936]), responses shape: torch.Size([16, 142])[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 77 zeros in ref_logprobs out of 726861824
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 61 zeros in ref_logprobs out of 2272
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 142]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 299]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 299]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 142]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 142]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.9304156908765435
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 14
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=7
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['35', '35', '35', '35', '35', '35', '35', '35', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 169])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 299])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 299])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 169])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 169])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 83 zeros in ref_logprobs out of 617467904
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 67 zeros in ref_logprobs out of 2000
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 125]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 254]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 254]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 125]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 125]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 169])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 299])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 299])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 169])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 169])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=7
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 81 zeros in ref_logprobs out of 960235520
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 65 zeros in ref_logprobs out of 3760
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 235]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 395]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 395]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 235]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 235]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1106151342391968
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.026213912293314934
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5389376878738403
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9477819204330444
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=7
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.691726565361023
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.01103884819895029
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.3556153774261475
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9800602793693542
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2961], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9255], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1106151342391968
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.013122948817908764
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5389376878738403
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9343659281730652
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -3.2186e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6568499803543091
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.013084560632705688
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.543134093284607
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9969990849494934
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.691726565361023
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.009054448455572128
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8885759115219116
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9731310606002808
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -4.8876e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -3.2186e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6568499803543091
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006230206694453955
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.543134093284607
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9977771043777466
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -4.8876e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([4, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5546613931655884
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.010845927521586418
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.4277608394622803
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9789623022079468
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([4, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.42942798137664795
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0072204479947686195
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.112640619277954
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9673418998718262
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 2.883167266845703
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.007218494080007076
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.373172640800476
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8086031079292297
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0002], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4305e-06, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19, 20], device='cuda:0'),)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.7418e-06, -2.3231e-04,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6,  8, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.7418e-06, -2.3231e-04,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6,  8, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.5616e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 2.883167266845703
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0021968656219542027
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4507242441177368
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7036289572715759
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0004,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0002,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5,  6,  8, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 2, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0002,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6,  8, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0004,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0004,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.5616e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0002,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6,  8, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 2, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 2, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 2, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.5616e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.39682769775390625
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0019805682823061943
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2773723602294922
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4104148745536804
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0002,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5,  6,  8, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0004,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.5616e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.39682769775390625
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0023325015790760517
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2773723602294922
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4326918125152588
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.06254798173904419
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0018933232640847564
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2491371631622314
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.1638103723526001
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5099432468414307
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.001095867482945323
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.172401785850525
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.059504084289073944
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.12055692821741104
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003210371593013406
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3099110126495361
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.12095248699188232
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5099432468414307
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0009668730781413615
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.172401785850525
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.036863893270492554
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 14
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 15
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 14
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.

[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 142]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 299]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 299]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 142]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 125, 151936]), responses shape: torch.Size([16, 125])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85', '85'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 125]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 254]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 254]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 125]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 235, 151936]), responses shape: torch.Size([16, 235])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 235]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 395]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 395]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 235]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['85', '85', '85', '85', '85', '85', '85', '85', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 235])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 395])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 395])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 235])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 235])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 235])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 395])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 395])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 235])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 235])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=1, seq=0: ref_logprob=0.0000, pi_logprob=-3.5380, diff=3.5380, token_id=576, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-3.5380, diff=3.5380, token_id=576, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=11, seq=0: ref_logprob=0.0000, pi_logprob=-3.5380, diff=3.5380, token_id=576, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=13, seq=0: ref_logprob=0.0000, pi_logprob=-3.5380, diff=3.5380, token_id=576, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=14, seq=0: ref_logprob=0.0000, pi_logprob=-3.5380, diff=3.5380, token_id=576, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 3.5380139350891113
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.021969541907310486
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5597453117370605
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7210484147071838
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5380], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([576], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=0, seq=0: ref_logprob=0.0000, pi_logprob=-3.5380, diff=3.5380, token_id=576, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-3.5380, diff=3.5380, token_id=576, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-3.5380, diff=3.5380, token_id=576, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=6, seq=0: ref_logprob=0.0000, pi_logprob=-3.5380, diff=3.5380, token_id=576, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=10, seq=0: ref_logprob=0.0000, pi_logprob=-3.5380, diff=3.5380, token_id=576, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 3.5380139350891113
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.06721168756484985
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.816591739654541
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5683510303497314
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.31740880012512207
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.012274818494915962
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.146201491355896
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8208982944488525
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4347018599510193
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0025687601882964373
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2009057998657227
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8796371817588806
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00, -1.1134e-04], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 15,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6,  7, 18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0002,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16, 17, 25, 29], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00, -1.1134e-04], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 15,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3667756915092468
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0021668169647455215
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4752016067504883
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8898380994796753
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7240862846374512
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.02511574886739254
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.159048080444336
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8839012384414673
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([29], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5484646558761597
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0014378192136064172
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4477019309997559
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9238420724868774
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  8, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -6.6874e-05,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -6.6874e-05,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  8, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.43641042709350586
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00014642438327427953
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7712302207946777
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8336588144302368
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3195e-04, -3.5763e-07,  0.0000e+00, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     19,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 12, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3543825149536133
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0004959359648637474
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6755683422088623
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7307340502738953
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.1012411117553711
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0004403126076795161
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1364045143127441
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.22910748422145844
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.9102249145507812
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.008210068568587303
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4003279209136963
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.11922377347946167
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00, -1.1134e-04], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 15,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00,  0.0000e+00, -4.0054e-05,  0.0000e+00,
[36m(PyTorchActorModel pid=3151076)[0m          0.0000e+00,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     15,     29,    366,     15,     29, 151643],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2, 10, 14, 15, 22, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00, -1.1134e-04], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 15,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7, 18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00,  0.0000e+00, -4.0054e-05,  0.0000e+00,
[36m(PyTorchActorModel pid=3151076)[0m          0.0000e+00,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     15,     29,    366,     15,     29, 151643],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2, 10, 14, 15, 22, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00, -1.1134e-04], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 15,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00, -1.1134e-04], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 15,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3667756915092468
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0005134413368068635
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6698276996612549
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9534251689910889
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  8, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -2.8610e-06, -4.7684e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 17, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  8, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -4.8959e-04], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  8, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -2.8610e-06, -4.7684e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 17, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -2.8610e-06, -4.7684e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 17, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  8, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7696213722229004
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0050645144656300545
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7712302207946777
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7745189666748047
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -5.3010e-04,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18, 26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0017], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3195e-04, -3.5763e-07,  0.0000e+00, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     19,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 12, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3195e-04, -3.5763e-07,  0.0000e+00, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     19,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 12, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0017], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.15173101425170898
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0019901832565665245
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5364526510238647
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5367064476013184
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -2.3842e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -2.3842e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.008292562328279018
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 1.5683284800616093e-05
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0847854614257812
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.11190338432788849
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.7558365745666835e-12
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 2.033421825017867e-12
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=2, self.version=7, self.vllm_weight_versions[worker_id]=7
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=1, self.version=7, self.vllm_weight_versions[worker_id]=7
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 95 zeros in ref_logprobs out of 753602560
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 63 zeros in ref_logprobs out of 3040
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 190]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=7, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 310]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 310]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 190]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 190]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 15
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 15
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.7439580066129565
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 84 zeros in ref_logprobs out of 850841600
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 68 zeros in ref_logprobs out of 3088
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 193]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=7, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 350]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 350]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 193]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 193]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 1.0449904222041368
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 16
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['35', '35', '35', '35', '35', '35', '35', '35', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 193])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 350])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 350])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 193])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 193])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=8
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 193])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 350])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 350])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 193])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 193])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])

[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 190, 151936]), responses shape: torch.Size([16, 190])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 190]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=7, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 310]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 310]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 190]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 193, 151936]), responses shape: torch.Size([16, 193])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35', '35'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 193]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=7, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 350]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 350]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 193]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=8
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 81 zeros in ref_logprobs out of 1074491392
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 49 zeros in ref_logprobs out of 4736
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 296]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=7, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 442]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 442]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 296]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 296]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9095962643623352
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.02220780774950981
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5783121585845947
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9828001260757446
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4876861572265625
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006551914848387241
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3330049514770508
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9973680377006531
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -3.5763e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5,  9, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5869606733322144
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0013118800707161427
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3710848093032837
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9701783657073975
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -7.1526e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24694204330444336
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001383270020596683
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.978446125984192
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7689855694770813
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=8
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0028], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8482489585876465
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.04087785631418228
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.260511875152588
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9927136301994324
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6072297096252441
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0011938984971493483
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7785135507583618
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9957519173622131
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -3.5763e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5,  9, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2435164451599121
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001116167288273573
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3710848093032837
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9703362584114075
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     22,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4,  8, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    20,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 4, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([4, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -7.1526e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.18914926052093506
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0005446270806714892
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.23856520652771
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3995693027973175
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24694204330444336
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0005472421762533486
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2390152215957642
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7351062893867493
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([4, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5,  6, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.18914926052093506
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1920883480343036e-07
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 1.4901103961850737e-10
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0945464372634888
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.2173762321472168
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0003110939869657159
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.263796329498291
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3489411175251007
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0790014266967773
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.1564812809228897
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0322293043136597
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.14989323914051056
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0002271577250212431
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -3.064785232709255e-06
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1530017852783203
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.16295477747917175
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0790014266967773
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.06601221859455109
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0322293043136597
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.059957291930913925
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 82 zeros in ref_logprobs out of 1567979520
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 66 zeros in ref_logprobs out of 7760
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 485]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 645]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 645]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 485]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 485]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 97 zeros in ref_logprobs out of 636915712
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 65 zeros in ref_logprobs out of 2272
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 142]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=7, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 262]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 262]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 142]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 142]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 16
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 17
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 16
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 485])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 645])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 645])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 485])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 485])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>

[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 296, 151936]), responses shape: torch.Size([16, 296])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 296]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=7, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 442]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 442]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 296]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 485, 151936]), responses shape: torch.Size([16, 485])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 485]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=6, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 645]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 645]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 485]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 142, 151936]), responses shape: torch.Size([16, 142])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 142]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=7, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 262]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 262]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 142]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['5', '5', '5', '5', '5', '5', '5', '5', '5', '5'...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [7, 6, 7, 7, 7, 7, 7, 7, 7, 6, 6, 6, 7, 7, 6, 7, 7...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 485])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 645])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 645])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 485])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 485])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 89 zeros in ref_logprobs out of 1084215296
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 73 zeros in ref_logprobs out of 4576
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 286]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=7, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 446]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 446]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 286]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 286]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=8
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=0, seq=0: ref_logprob=0.0000, pi_logprob=-15.4180, diff=15.4180, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-15.4180, diff=15.4180, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-15.4180, diff=15.4180, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=4, seq=0: ref_logprob=0.0000, pi_logprob=-15.4180, diff=15.4180, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-15.4180, diff=15.4180, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 15.417976379394531
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.15228573977947235
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7854779958724976
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3424284756183624
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -1.4782e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([51, 52], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -3.3588e-04, -2.3842e-07,  0.0000e+00, -1.1921e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([29, 30, 36, 40, 41], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -1.4782e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([51, 52], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7183654308319092
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0023774283472448587
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.55851411819458
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3267388641834259
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4180], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=1, seq=0: ref_logprob=0.0000, pi_logprob=-15.4180, diff=15.4180, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=7, seq=0: ref_logprob=0.0000, pi_logprob=-15.4180, diff=15.4180, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=9, seq=0: ref_logprob=0.0000, pi_logprob=-15.4180, diff=15.4180, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=10, seq=0: ref_logprob=0.0000, pi_logprob=-15.4180, diff=15.4180, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=13, seq=0: ref_logprob=0.0000, pi_logprob=-15.4180, diff=15.4180, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 15.417976379394531
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.09311104565858841
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.69394052028656
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5259819626808167
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([30, 31, 35, 37, 41], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6039333343505859
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.002886570291593671
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3841465711593628
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5163840055465698
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.7179e-05, -2.3842e-07,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22, 29, 33, 34], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -1.1921e-07, -3.3588e-04, -9.5367e-07,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 15,  29, 366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7, 11, 12, 19, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.7179e-05, -2.3842e-07,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22, 29, 33, 34], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -9.4175e-06, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5, 12, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.0490e-05, -3.3753e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([35, 36, 48], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9364068508148193
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0007917683105915785
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.299504280090332
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.14940892159938812
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-8.3446e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([33, 38], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-8.3446e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([33, 38], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2554967701435089
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0003210319555364549
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0764501094818115
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.09794272482395172
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 0.9999997615814209
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3600080907344818
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.3691294193267822
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.575061023235321
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.0490e-05, -3.3753e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([35, 36, 48], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07, -5.8411e-05, -3.5763e-07, -1.1921e-07,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([23, 24, 31, 35, 36], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.0490e-05, -3.3753e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([35, 36, 48], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.0490e-05, -3.3753e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([35, 36, 48], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -1.1921e-07, -3.3588e-04, -9.5367e-07,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 15,  29, 366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7, 11, 12, 19, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.0897e-03, -1.1921e-07,  0.0000e+00, -9.5367e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([40, 41, 50, 54, 55], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.3133e+00, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([43, 44, 49, 55], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -1.1921e-07, -3.3588e-04, -9.5367e-07,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 15,  29, 366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7, 11, 12, 19, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.0490e-05, -3.3753e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([35, 36, 48], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07, -5.8411e-05, -3.5763e-07, -1.1921e-07,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([23, 24, 31, 35, 36], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.3132920265197754
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.004106780514121056
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4537750482559204
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3788392245769501
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-8.3446e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([33, 38], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-8.3446e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([33, 38], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2554967701435089
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00046285256394185126
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2601784467697144
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.1753212809562683
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4305e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([56], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4305e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([56], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4305e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([56], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.07674393057823181
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00042277967440895736
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0858886241912842
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3508893549442291
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5796311497688293
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0015472263330593705
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6998703479766846
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.644036591053009
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.3691294193267822
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5052868127822876
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=3, self.version=8, self.vllm_weight_versions[worker_id]=8
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3197810649871826
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2716881036758423
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.2541787028312683
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.001790942857041955
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9290564060211182
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5615556836128235
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.5824e-04, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([36, 56], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.5824e-04, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([36, 56], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.5824e-04, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([36, 56], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.22064542770385742
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.000310261471895501
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4854111671447754
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.33111655712127686
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 80 zeros in ref_logprobs out of 870289408
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 64 zeros in ref_logprobs out of 3008
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 188]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 358]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 358]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 188]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 188]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=0, self.version=8, self.vllm_weight_versions[worker_id]=8
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 105 zeros in ref_logprobs out of 870289408
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 71 zeros in ref_logprobs out of 3392
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 212]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 358]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 358]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 212]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 212]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 17
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 17
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=1, self.version=8, self.vllm_weight_versions[worker_id]=8

[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 286, 151936]), responses shape: torch.Size([16, 286])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 286]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=7, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 446]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 446]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 286]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 188, 151936]), responses shape: torch.Size([16, 188])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 188]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 358]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 358]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 188]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 212, 151936]), responses shape: torch.Size([16, 212])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 212]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 358]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 358]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 212]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 257, 151936]), responses shape: torch.Size([16, 257])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 257]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 417]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 417]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 257]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 74 zeros in ref_logprobs out of 1013716992
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 58 zeros in ref_logprobs out of 4112
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000', '448000'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 257]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 417]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 417]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 257]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 257]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=2, self.version=8, self.vllm_weight_versions[worker_id]=8
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.6669351691380143
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 104 zeros in ref_logprobs out of 751171584
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 72 zeros in ref_logprobs out of 2608
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 163]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 309]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 309]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 163]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 163]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.9544020779430866
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 18
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['800', '800', '800', '800', '800', '800', '800',...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 257])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 417])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 417])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 257])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 257])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 257])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 417])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 417])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 257])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 257])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 94 zeros in ref_logprobs out of 828962816
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 61 zeros in ref_logprobs out of 2992
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 187]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 341]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 341]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 187]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 187]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=9
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.2387700080871582
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.04064003378152847
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8961628675460815
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8780320882797241
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.2473], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.2387700080871582
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.040232956409454346
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8961628675460815
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.849040687084198
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0017], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0017], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.080552577972412
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.005202197935432196
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0017], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.080552577972412
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.005396869033575058
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3285415172576904
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8959453105926514
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3285415172576904
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9144099950790405
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7105106115341187
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0017245752969756722
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4396164417266846
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8870326280593872
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7105106115341187
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.005829271394759417
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -1.4054e-04,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 14, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4396164417266846
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8788415193557739
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -5.2339e-03, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.1269,  0.0000,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  15,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1,  2,  7,  9, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8391848802566528
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0020926636643707752
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -5.2339e-03, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.1269,  0.0000,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2,  7,  9, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6689484119415283
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9264883995056152
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -5.2339e-03, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -5.2339e-03, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6539793014526367
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.008024810813367367
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4484740495681763
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8836580514907837
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-06, -2.4809e-03,  0.0000e+00, -2.0266e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 0,  1, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7881e-06, -2.3064e-04,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  19], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 25, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7881e-06, -2.3064e-04,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  19], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 25, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07, -9.1165e-04, -7.1526e-07,  0.0000e+00, -1.1921e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 15, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8020941019058228
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00410112040117383
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.650659203529358
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8372842073440552
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 15, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 26, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1369000673294067
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006816191598773003
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.255934000015259
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7751373648643494
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.0729e-06, -2.6446e-03,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([22, 23, 32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.0729e-06, -2.6446e-03,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22, 23, 32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.0729e-06, -2.6446e-03,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22, 23, 32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.0199090242385864
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0013090162537992
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.77793288230896
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6459234952926636
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.0199090242385864
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0030101523734629154
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.8147e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3, 5, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.4543391444021836e-05
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0013607860310003161
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1867843866348267
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3342568576335907
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1072386503219604
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.04508895426988602
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.77793288230896
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5915725231170654
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.8147e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.8147e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3, 5, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3, 5, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3, 5, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.4543391444021836e-05
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004082362167537212
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2683223485946655
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.33063289523124695
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1477446556091309
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.053197022527456284
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0

[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 163, 151936]), responses shape: torch.Size([16, 163])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 163]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 309]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 309]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 163]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 187, 151936]), responses shape: torch.Size([16, 187])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 187]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 341]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 341]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 187]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 203, 151936]), responses shape: torch.Size([16, 203])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 203]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 373]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 373]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 203]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 66 zeros in ref_logprobs out of 906754048
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 50 zeros in ref_logprobs out of 3248
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 203]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 373]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 373]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 203]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 203]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=9
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 18
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 19
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 18
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 203])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 373])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 373])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 203])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 203])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['43', '43', '43', '43', '43', '43', '43', '43', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 203])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 373])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 373])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 203])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 203])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 106 zeros in ref_logprobs out of 824100864
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 74 zeros in ref_logprobs out of 3088
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 193]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 339]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 339]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 193]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 193]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=9
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8280210494995117
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.014127864502370358
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6592750549316406
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9320312142372131
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5783993005752563
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.008016111329197884
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5405e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([311], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.967103123664856
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9993026852607727
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.26172950863838196
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006384401582181454
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5640519857406616
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 1.0015853643417358
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8280210494995117
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0012541417963802814
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6592750549316406
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9086158275604248
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.23795169591903687
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004384668078273535
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.16937518119812
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 1.0007890462875366
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -2.6226e-06,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5,  7, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.41494321823120117
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0034554956946521997
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.310897946357727
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9996552467346191
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-06, -3.6238e-03,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18, 20, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -2.6226e-06,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5,  7, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9834229946136475
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.005140249151736498
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.175696849822998
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8648510575294495
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-06, -3.6238e-03,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18, 20, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8939228057861328
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0009669291321188211
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.175696849822998
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9447973370552063
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.0729e-06,  0.0000e+00,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13, 14, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 15, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1583340167999268
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004574508406221867
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2789151668548584
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6816818714141846
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 15, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5163928270339966
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.002729472704231739
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    23,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2789151668548584
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7887040376663208
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1802e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.1905207633972168
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001327545614913106
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2010979652404785
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5634334683418274
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1802e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.3113e-06,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     22,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3, 5, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.190049409866333
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0007896289462223649
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1330171823501587
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5263394117355347
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([4, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5,  7, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.566297173500061
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.010593486949801445
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1761200428009033
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.19138656556606293
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([4, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0000888109207153
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.0604168139398098
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5,  7, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0011267662048339844
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0004023381043225527
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1255908012390137
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.12960997223854065
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0000888109207153
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.0302084069699049
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=3, self.version=9, self.vllm_weight_versions[worker_id]=9
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 75 zeros in ref_logprobs out of 1011286016
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 59 zeros in ref_logprobs out of 3936
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 246]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 416]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 416]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 246]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 246]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=9
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 76 zeros in ref_logprobs out of 794929152

[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 193, 151936]), responses shape: torch.Size([16, 193])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800', '800'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 193]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 339]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 339]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 193]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 246, 151936]), responses shape: torch.Size([16, 246])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 246]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=8, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 416]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 416]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 246]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 173, 151936]), responses shape: torch.Size([16, 173])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 173]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=9, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 327]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 327]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 173]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 44 zeros in ref_logprobs out of 2768
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 173]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=9, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 327]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 327]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 173]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 173]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 19
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 19
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.6603375412523746
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 93 zeros in ref_logprobs out of 826531840
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 60 zeros in ref_logprobs out of 2976
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 186]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=9, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 340]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 340]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 186]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 186]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.8886973289772868
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 20
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['16', '16', '16', '16', '16', '16', '16', '16', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 340])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 340])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=10
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 340])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 340])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5987033247947693
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.015139905735850334
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7482540607452393
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9405859708786011
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8493471145629883
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001138014835305512
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.4438e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([882], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5929132103919983
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.027304381132125854
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.262542486190796
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9369292259216309
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.297234058380127
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9920217394828796
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8493471145629883
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004956109449267387
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2696171998977661
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9677548408508301
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 2, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.4305e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -8.4993e-05,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.49517321586608887
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.002176097594201565
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3091660737991333
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9781526923179626
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -8.4993e-05,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 19, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.4305e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.49517321586608887
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0018,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.2994e-05,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 14, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0025,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0004404219798743725
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3091660737991333
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9090585708618164
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07, -1.5854e-04,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.2994e-05,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 14, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0018,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0025,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0025,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.2994e-05,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 14, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0018,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.48479509353637695
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0025,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.008387066423892975
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2045994997024536
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7856204509735107
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0018,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.410597562789917
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006177559029310942
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2569007873535156
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7452093958854675
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.44349098205566406
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.05142825096845627
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3489652872085571
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5669803619384766
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24818181991577148
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.05061867833137512
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4588189125061035
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4653688669204712
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.6689e-06, -4.8589e-02,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2,  4,  9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07, -4.0788e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7,  9, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07, -4.0788e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7,  9, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2408088743686676
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0006584959919564426
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3947923183441162
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3729545474052429
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9488253593444824
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0016123317182064056
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3947923183441162
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3325960338115692
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.36687588691711426
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00037438562139868736
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.193674921989441
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.19434510171413422
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0023045539855957
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.06376529484987259
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07, -9.7408e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07, -9.7408e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9740820527076721
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0028331996873021126
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1041487455368042
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.11473562568426132
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0023045539855957
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.029975401237607002
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=10
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 89 zeros in ref_logprobs out of 680673280
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 57 zeros in ref_logprobs out of 2224
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 139]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=9, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 280]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 280]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 139]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 139]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 20
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 21
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=10
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 20

[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 186, 151936]), responses shape: torch.Size([16, 186])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 186]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=9, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 340]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 340]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 186]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 139, 151936]), responses shape: torch.Size([16, 139])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 139]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=9, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 280]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 280]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 139]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 340])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 340])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['16', '16', '16', '16', '16', '16', '16', '16', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 340])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 340])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 186])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=10
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=0, self.version=10, self.vllm_weight_versions[worker_id]=10
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6137447357177734
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.009744187816977501
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.465135931968689
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9713886976242065
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([1899], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.457255482673645
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.011622617952525616
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3809678554534912
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9690336585044861
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3198206424713135
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0013610500609502196
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3355859518051147
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9320569038391113
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3590388298034668
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0025717425160109997
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3355859518051147
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9345871210098267
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0002,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0002,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 19, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.1775226593017578
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0011795696336776018
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3076701164245605
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.993916392326355
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 2, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 2, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4780702590942383
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004692115820944309
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3059784173965454
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9246704578399658
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0009,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0028,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0009,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0046,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.398983359336853
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.011485189199447632
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3597650527954102
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9358934760093689
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0028,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0046,  0.0000,  0.0000], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5089206695556641
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0018945380579680204
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3597650527954102
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8367705345153809
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5327873229980469
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0010441060876473784
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4741394519805908
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8233453631401062
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.9605e-07, -1.1049e-02,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6,  7,  9, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.9605e-07, -1.1049e-02,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6,  7,  9, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24068167805671692
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003292954294010997
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4717296361923218
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6028854250907898
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5685471296310425
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0006351624033413827
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0829027891159058
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.31761327385902405
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.12367033958435059
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0009094072738662362
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4741394519805908
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6641051173210144
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.6689e-06, -1.0021e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2,  4,  9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6742110252380371
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00040216962224803865
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4717296361923218
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.39808666706085205
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07, -1.3133e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.3132659196853638
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0023146376479417086
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4521067142486572
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.1869528889656067
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0133373737335205
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.09766402840614319
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0133373737335205
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.04002472385764122
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=3, self.version=10, self.vllm_weight_versions[worker_id]=10
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 92 zeros in ref_logprobs out of 918908928
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 60 zeros in ref_logprobs out of 3584
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 224]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=9, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 378]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 378]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 224]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 224]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 21
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 21
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=0, self.version=10, self.vllm_weight_versions[worker_id]=10
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=2, self.version=10, self.vllm_weight_versions[worker_id]=10
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.9390222057700157
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.6118304328992963
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 22
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['1080', '1080', '1080', '1080', '1080', '1080', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 224])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 378])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 378])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 224])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 224])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 224])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 378])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 378])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 224])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 224])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=11
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1364545822143555
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.013670215383172035
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2964715957641602
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8503639101982117
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=11
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([9217], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1364545822143555
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.023450221866369247
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7436896562576294
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8678646683692932
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.932675302028656
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004310199525207281
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3443055152893066
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9294962882995605
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -2.7537e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7490072250366211
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0010937032056972384
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4200619459152222
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.950789213180542
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([17], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8965287804603577
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00022971259022597224
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3443055152893066
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9199079275131226
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -3.1352e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16, 17, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -3.1352e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16, 17, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07, -3.8080e-04,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.7537e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.7537e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7490072250366211
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003891030326485634
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.6847174167633057
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8902894854545593

[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 224, 151936]), responses shape: torch.Size([16, 224])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 224]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=9, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 378]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 378]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 224]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 211, 151936]), responses shape: torch.Size([16, 211])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 211]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=9, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 381]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 381]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 211]), device=cuda:0, dtype=torch.int64, is_shared=True),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 82 zeros in ref_logprobs out of 926201856
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 66 zeros in ref_logprobs out of 3376
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43', '43'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 211]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=9, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 381]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 381]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 211]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 211]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.9605e-07, -2.9631e-04,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2607918679714203
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0026658796705305576
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4464795589447021
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7941585779190063
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.6294e-06, -1.1086e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13, 14, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000, -0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07, -1.1921e-06,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07, -4.5418e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.9605e-07, -2.9631e-04,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.9605e-07, -2.9631e-04,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.9605e-07, -2.9631e-04,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.45861339569091797
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006018477957695723
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3427096605300903
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9156408905982971
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0005,  0.0000,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07, -1.1921e-06,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.6294e-06, -1.1086e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 14, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07, -1.1921e-06,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.6294e-06, -1.1086e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 14, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0005,  0.0000,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000, -0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.6294e-06, -1.1086e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 14, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.40970325469970703
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0006801915005780756
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 5.539880752563477
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7502270340919495
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5, 13, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.40970325469970703
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0016603978583589196
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 5.539880752563477
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6874217391014099
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24284589290618896
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00023856532061472535
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.548305630683899
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4706959128379822
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2737849950790405
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.34498634934425354
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.036752700805664
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.09759549051523209
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -2.2650e-06,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     23,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 12, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24284589290618896
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0007958415080793202
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5517760515213013
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.47810688614845276
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2690070867538452
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0008101820130832493
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2737849950790405
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.14785750210285187
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4782e-05,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3081018328666687
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 3.9624494093004614e-05
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1764626502990723
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.06414739042520523
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 102 zeros in ref_logprobs out of 695259136
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 69 zeros in ref_logprobs out of 2112
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 132]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 286]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 286]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 132]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 132]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=11
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=11
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 22
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 23
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=3, self.version=11, self.vllm_weight_versions[worker_id]=11
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 22
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['43', '43', '43', '43', '43', '43', '43', '43', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [9, 9, 10, 9, 10, 9, 10, 10, 10, 10, 10, 9, 9, 10,...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 211])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 381])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 381])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 211])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 211])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 211])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 381])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 381])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 211])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 211])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6928517818450928
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00039695866871625185
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.048088550567627
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8766469955444336
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.2650e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.666041374206543
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006324566900730133
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4700398445129395
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9471760988235474
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5424232482910156
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0001471243449486792
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5029220581054688
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9239867925643921
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -8.3446e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -9.0599e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([25, 26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8668426275253296
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0029086724389344454
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3657830953598022
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9728342294692993
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2, 3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8610e-06,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1, 3, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.6586], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6928517818450928
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.000916701799724251
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.807431697845459
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8699886202812195
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.2650e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5209436416625977
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0026313362177461386
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4700398445129395
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9404834508895874
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6132597923278809
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -7.226470188470557e-05
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4670957326889038
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9166697859764099
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -9.0599e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([25, 26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.44329190254211426
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0029621445573866367
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2915977239608765
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9693398475646973
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7881e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7881e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.7881e-06,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     22,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 3, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.1526e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00, -2.3842e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16, 17, 19, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1022686958312988
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0014218796277418733
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.7881e-06,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     22,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 3, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2267045974731445
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8920349478721619
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.1526e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00, -2.3842e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([16, 17, 19, 24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7881e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1022686958312988
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0015359249664470553
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2813397645950317
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9406394362449646
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 81 zeros in ref_logprobs out of 797360128
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 49 zeros in ref_logprobs out of 2896
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 181]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 328]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 328]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 181]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 181]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.5913e-04, -3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 2, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.5913e-04, -3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 14, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0004,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.5913e-04, -3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 2, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.5913e-04, -3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.2292e-05, -3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1,  2,  4,  9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.510836124420166
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.002440155018121004
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.234052062034607
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6726118922233582
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.2292e-05, -3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2,  4,  9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 14, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 2, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 14, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.5913e-04, -3.5763e-07,  0.0000e+00,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 10, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0004,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 14, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.510836124420166
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0009884575847536325
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5722360610961914
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.761894166469574
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=1, self.version=11, self.vllm_weight_versions[worker_id]=11
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.19961917400360107
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0003090006939601153
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6016539335250854
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.2776918113231659
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 2.622591182444012e-06
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -2.44270522671286e-05
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0056551694869995
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.021447107195854187
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8610e-06,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8610e-06,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([22, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.19961917400360107
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0027192889247089624
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6016539335250854
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.42480215430259705
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-6.9141e-06, -4.5418e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 14, 16, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-6.9141e-06, -4.5418e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 14, 16, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.07033824920654297
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0010410543764010072
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.077370047569275
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.17174032330513
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.

[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 132, 151936]), responses shape: torch.Size([16, 132])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 132]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 286]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 286]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 132]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 181, 151936]), responses shape: torch.Size([16, 181])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 181]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 328]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 328]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 181]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 123, 151936]), responses shape: torch.Size([16, 123])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 123]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 264]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 264]), device=cuda:0, dtype=torch.int64, is_shared=True),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 96 zeros in ref_logprobs out of 641777664
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 64 zeros in ref_logprobs out of 1968
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 123]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 264]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 264]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 123]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 123]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 96 zeros in ref_logprobs out of 838686720
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 64 zeros in ref_logprobs out of 3056
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 191]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 191]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 191]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=0, self.version=11, self.vllm_weight_versions[worker_id]=11
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 93 zeros in ref_logprobs out of 875151360
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 61 zeros in ref_logprobs out of 3296
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 206]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 360]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 360]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 206]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 206]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 23
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 23
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 78 zeros in ref_logprobs out of 741447680
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 46 zeros in ref_logprobs out of 2528
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 158]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 158]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 158]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.6588424211367965
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 83 zeros in ref_logprobs out of 773050368
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 51 zeros in ref_logprobs out of 2832
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 177]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 318]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 318]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 177]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 177]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1

[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 123]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 191, 151936]), responses shape: torch.Size([16, 191])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 191]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 191]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 206, 151936]), responses shape: torch.Size([16, 206])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 206]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 360]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 360]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 206]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 158, 151936]), responses shape: torch.Size([16, 158])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 158]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 305]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 158]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 177, 151936]), responses shape: torch.Size([16, 177])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 177]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 318]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 318]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 177]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 198, 151936]), responses shape: torch.Size([16, 198])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 198]), device=cuda:0, dtype=torch.float32, is_shared=True),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 73 zeros in ref_logprobs out of 838686720
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 40 zeros in ref_logprobs out of 3168
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 198]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 198]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 198]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.9013068033382297
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 24
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['7', '7', '7', '7', '7', '7', '7', '7', '7', '7'...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 1...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 198])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 345])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 345])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 198])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 198])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 198])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 345])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 345])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 198])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 198])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 53 zeros in ref_logprobs out of 687966208
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 37 zeros in ref_logprobs out of 1792
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 112]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 283]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 283]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 112]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 112]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=12
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=12
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 110 zeros in ref_logprobs out of 838686720
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 78 zeros in ref_logprobs out of 3056
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 191]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 191]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 191]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4663e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([21], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9412873387336731
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.021915871649980545
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2630423307418823
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9618504047393799
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.589015007019043
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.010702857747673988
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3858879804611206
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9978353381156921
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8997913599014282
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004999693017452955
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2139970064163208
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9426464438438416
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6592278480529785
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004073078744113445
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.474272608757019
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9976687431335449
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7829544544219971
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0006664225948043168
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2161946296691895
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9398437142372131
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -3.4571e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7829544544219971
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00025834713596850634
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1335067749023438
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9800240993499756
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.4305e-06,  0.0000e+00, -2.3842e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -1.7987e-04,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([15, 16, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -1.7987e-04,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 16, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.4305e-06,  0.0000e+00, -2.3842e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.4305e-06,  0.0000e+00, -2.3842e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -1.7987e-04,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([15, 16, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6968204975128174
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0016960380598902702
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.391626238822937
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7552686929702759
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8940404653549194
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0013850077521055937
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2466669082641602
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8116540908813477
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 12, 18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7496568560600281
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0096129784360528
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1926418542861938
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.49998387694358826
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -3.4571e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0001], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7496568560600281
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.008558643981814384
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1926418542861938
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.40656450390815735
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -1.1921e-07,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9316108226776123
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0013361991150304675
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1063735485076904
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.2970205545425415
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.2300560474395752
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.030567793175578117
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1245983839035034
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.10304668545722961
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9316108226776123
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 2.2524818632518873e-05
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1125695705413818
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.24454031884670258
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.36876440048217773
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -8.072798664215952e-05
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1326298713684082
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.13484252989292145
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1206e-05,  0.0000e+00, -8.3446e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6598455905914307
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0013490127166733146
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6442134380340576
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.08214704692363739
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1206e-05,  0.0000e+00, -8.3446e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6598455905914307
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0003053368127439171
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6442134380340576
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.045560937374830246

[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=10, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 198]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 112, 151936]), responses shape: torch.Size([16, 112])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 112]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 283]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 283]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 112]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 191, 151936]), responses shape: torch.Size([16, 191])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16', '16'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 191]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 345]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 191]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 151, 151936]), responses shape: torch.Size([16, 151])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 151]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 298]), device=cuda:0, dtype=torch.bool, is_shared=True),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 71 zeros in ref_logprobs out of 724430848
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 35 zeros in ref_logprobs out of 2416
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 151]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 298]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 298]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 151]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 151]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=12
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 48 zeros in ref_logprobs out of 918908928
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 32 zeros in ref_logprobs out of 3120
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 195]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 378]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 378]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 195]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 195]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 95 zeros in ref_logprobs out of 697690112
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 63 zeros in ref_logprobs out of 2336
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 146]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 287]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 287]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 146]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 146]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 52 zeros in ref_logprobs out of 702552064
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 36 zeros in ref_logprobs out of 1888
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 118]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 118]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 118]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 24
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 25
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 24
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['62', '62', '62', '62', '62', '62', '62', '62', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 1...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 146])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 289])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 289])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 146])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 146])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between

[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 298]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 151]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 195, 151936]), responses shape: torch.Size([16, 195])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 195]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 378]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 378]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 195]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 146, 151936]), responses shape: torch.Size([16, 146])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080', '1080'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 146]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 287]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 287]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 146]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 118, 151936]), responses shape: torch.Size([16, 118])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 118]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 118]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 146])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 289])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 289])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 146])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 146])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643,     32,  10435,   1948], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|>A conversation between
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 131 zeros in ref_logprobs out of 1436706816
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 98 zeros in ref_logprobs out of 7104
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.871511697769165
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.018601417541503906
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7480326890945435
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9752693176269531
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 17], device='cuda:0'),)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=12
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0133], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([323], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.871511697769165
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.014744691550731659
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2014042139053345
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9668408632278442
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 10, 12, 18], device='cuda:0'),)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 444]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 591]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 591]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 444]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 444]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5603117942810059
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0034766762983053923
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4472746849060059
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.95379239320755
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 10, 12, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 15, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 15, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 15, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.35509443283081055
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001042611082084477
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4472746849060059
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9422115683555603
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.1967158317565918
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.002703060396015644
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2756308317184448
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8849480152130127
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6680183410644531
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0023601362481713295
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1828510761260986
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8810107707977295
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 4,  5,  7, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3,  4,  6, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6,  7,  9, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 4,  5,  7, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 6,  7,  9, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4,  6, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 3,  4,  6, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4020177721977234
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.009296385571360588
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1759049892425537
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7751351594924927
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.1708383560180664
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.009747032076120377
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1585043668746948
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7843069434165955
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6493497490882874
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00022320191783364862
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.10004723072052
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4776328206062317
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2,  3,  5, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2,  3,  5, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6493497490882874
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0007095196633599699
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.10004723072052
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3932184875011444
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.1469038724899292
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0014240317977964878
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1291581392288208
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.23302289843559265
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 2,  3,  5, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0471909046173096
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.08299481123685837
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0032252073287964
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.02973688207566738
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.30625542998313904
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.000821121851913631
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3243563175201416
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.18386340141296387
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0007719546556472778
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00012269653961993754
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1012269258499146
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.12090221047401428
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.18536193668842316
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001932723680511117
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0427182912826538
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.08930753171443939
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=3, self.version=12, self.vllm_weight_versions[worker_id]=12
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 96 zeros in ref_logprobs out of 702552064
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 64 zeros in ref_logprobs out of 2304
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 144]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 144]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 144]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 25
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 25
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=1, self.version=12, self.vllm_weight_versions[worker_id]=12
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.695077121257782
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 71 zeros in ref_logprobs out of 884875264
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 39 zeros in ref_logprobs out of 3472
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 217]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 364]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 364]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 217]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 217]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.9928731760010123
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 26
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['7', '7', '7', '7', '7', '7', '7', '7', '7', '7'...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 1...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 217])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 364])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 364])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 217])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 217])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and

[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 444, 151936]), responses shape: torch.Size([16, 444])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 444]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=11, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 591]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 591]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 444]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 144, 151936]), responses shape: torch.Size([16, 144])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 144]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 289]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 144]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 217, 151936]), responses shape: torch.Size([16, 217])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7', '7'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 217]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 364]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 364]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 217]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=13
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 217])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 364])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 364])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 217])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 217])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 55 zeros in ref_logprobs out of 982114304
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 39 zeros in ref_logprobs out of 3536
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 221]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 404]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 404]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 221]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 221]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.0701104402542114
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.008098039776086807
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2962135076522827
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8865536451339722
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2159e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([522], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.0701104402542114
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.02425548806786537
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.193616271018982
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8737877607345581
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8210973739624023
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00486981775611639
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.28304922580719
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9330421686172485
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6170692443847656
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00398471113294363
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2303166389465332
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9202353358268738
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6470690369606018
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004561970476061106
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.1526e-07, -1.0334e-03], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([25, 26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6470690369606018
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.012973183766007423
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2925796508789062
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9635446071624756
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2925796508789062
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9567100405693054
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.5497e-06, -1.1050e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.5497e-06, -1.1050e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.5497e-06, -1.1050e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -4.0789e-03,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5096595287322998
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.008642982691526413
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4848214387893677
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.007294361479580402
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3475674390792847
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9583852887153625
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3475674390792847
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9452729225158691
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07, -2.2650e-06,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2517e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2517e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7881e-06,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.2517e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7166163921356201
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0031044543720781803
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4013946056365967
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7706539034843445
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0005064078723080456
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0006140295299701393
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1232801675796509
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4665733277797699
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1928178071975708
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.26316991448402405
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0142029523849487
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.12486104667186737
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=13
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -2.2650e-06,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7881e-06,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -2.2650e-06,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 9, 10, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-6.3181e-06,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.841886043548584
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0011765575036406517
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4013946056365967
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7782439589500427
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.27042150497436523
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00015426873869728297
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1270686388015747
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.47888171672821045
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.190267562866211
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.001303145894780755
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1928178071975708
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.2648429870605469
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.5367e-07, -1.7978e-01,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.17978259921073914
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0012696011690422893
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3331252336502075
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.1650337129831314
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 90 zeros in ref_logprobs out of 760895488
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 57 zeros in ref_logprobs out of 2656
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 166]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 313]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 313]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 166]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 166]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 26
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 27
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 26
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 221])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 404])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 404])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 221])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 221])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 82 zeros in ref_logprobs out of 989407232
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 66 zeros in ref_logprobs out of 3712
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 232]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 407]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 407]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 232]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 232]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)

[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 221, 151936]), responses shape: torch.Size([16, 221])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 221]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 404]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 404]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 221]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 166, 151936]), responses shape: torch.Size([16, 166])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 166]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 313]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 313]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 166]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 232, 151936]), responses shape: torch.Size([16, 232])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 232]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 407]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 407]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 232]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['5', '5', '5', '5', '5', '5', '5', '5', '5', '5'...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 1...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 221])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 404])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 404])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 221])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 221])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=13
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 2.6149017810821533
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.03513370081782341
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4455822706222534
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9566984176635742
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5827598571777344
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.005989029072225094
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4295545816421509
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9296495914459229
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3423333168029785
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0139250997453928
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8363574743270874
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 1.0026822090148926
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.6689e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.6332e-05, -1.2040e-05,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.5034e-06, -1.0252e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07, -6.3181e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([10, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07, -6.3181e-06,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 2.3656415939331055
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.006034203805029392
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.233870506286621
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.926990270614624
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=2, self.version=13, self.vllm_weight_versions[worker_id]=13
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.6149], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([7324], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 2.6149017810821533
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.034748367965221405
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2953300476074219
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9527222514152527
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9320774078369141
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0014456926146522164
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2826669216156006
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9274100065231323
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0005], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0005], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3423333168029785
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0075672101229429245
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7705719470977783
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 1.0009212493896484
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.6332e-05, -1.2040e-05,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.5034e-06, -1.0252e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 2.3656415939331055
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0017533386126160622
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3710030317306519
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9242693185806274
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.9802e-06, -2.7775e-05,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5,  6, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.36899900436401367
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.000387941807275638
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.284010887145996
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6989771723747253
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 14, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 14, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.36899900436401367
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0040203058160841465
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.284010887145996
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7508208751678467
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.34508979320526123
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0021953952964395285
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.154990792274475
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5437105894088745
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24584174156188965
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004542755428701639
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1613812446594238
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.40103477239608765
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0880391001701355
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0006249508587643504
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1397749185562134
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.1923794150352478
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.34508979320526123
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00033315306063741446
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3875123262405396
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.2093152403831482
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24584174156188965
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0011356892064213753
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.232081413269043
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.10085903108119965
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0880391001701355
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0001562377146910876
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1397749185562134
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.05594627186655998
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=0, self.version=13, self.vllm_weight_versions[worker_id]=13
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 50 zeros in ref_logprobs out of 707414016
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 34 zeros in ref_logprobs out of 1920
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 120]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 291]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 291]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 120]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 120]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 85 zeros in ref_logprobs out of 736585728
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 53 zeros in ref_logprobs out of 2528
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 158]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 303]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 303]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 158]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 158]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 79 zeros in ref_logprobs out of 1003993088
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 47 zeros in ref_logprobs out of 4256
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 266]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 413]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 413]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 266]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 266]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 27
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 27
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=13
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=3, self.version=13, self.vllm_weight_versions[worker_id]=13
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 102 zeros in ref_logprobs out of 634484736
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 70 zeros in ref_logprobs out of 1888
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 118]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 261]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 261]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 118]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 118]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.6903655901551247
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.9345117844641209
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 28
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics

[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 120, 151936]), responses shape: torch.Size([16, 120])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 120]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 291]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 291]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 120]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 158, 151936]), responses shape: torch.Size([16, 158])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 158]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 303]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 303]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 158]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 266, 151936]), responses shape: torch.Size([16, 266])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5', '5'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 266]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=12, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 413]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 413]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 266]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 118, 151936]), responses shape: torch.Size([16, 118])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 118]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 261]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 261]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 118]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 266])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 413])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 413])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 266])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 266])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['8', '8', '8', '8', '8', '8', '8', '8', '8', '8'...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [13, 13, 12, 13, 12, 12, 13, 13, 13, 12, 12, 13, 1...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 266])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 413])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 413])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 266])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 266])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=0, seq=0: ref_logprob=0.0000, pi_logprob=-15.4877, diff=15.4877, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=1, seq=0: ref_logprob=0.0000, pi_logprob=-15.4877, diff=15.4877, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-15.4877, diff=15.4877, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=6, seq=0: ref_logprob=0.0000, pi_logprob=-15.4877, diff=15.4877, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=7, seq=0: ref_logprob=0.0000, pi_logprob=-15.4877, diff=15.4877, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-15.4877], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-15.4877, diff=15.4877, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=4, seq=0: ref_logprob=0.0000, pi_logprob=-15.4877, diff=15.4877, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=7, seq=0: ref_logprob=0.0000, pi_logprob=-15.4877, diff=15.4877, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=9, seq=0: ref_logprob=0.0000, pi_logprob=-15.4877, diff=15.4877, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=10, seq=0: ref_logprob=0.0000, pi_logprob=-15.4877, diff=15.4877, token_id=151643, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 15.487717628479004
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.15988412499427795
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.827552318572998
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6862612366676331
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 15.487717628479004
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.1680552065372467
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.827552318572998
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6603212952613831
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07, -1.1086e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([27, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07, -1.1086e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([27, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07, -1.1086e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([27, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.3851375579833984
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0038707454223185778
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5859794616699219
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7986100316047668
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07, -1.1086e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([27, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.3851375579833984
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.005951923783868551
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5859794616699219
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8152814507484436
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.6028e-06, -8.6151e-03,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5,  6, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.1526e-07, -3.1352e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.6028e-06, -8.6151e-03,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.6028e-06, -8.6151e-03,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.5775e-05, -2.3842e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.5367e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-9.5367e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.5367e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.1526e-07, -3.1352e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.6028e-06, -8.6151e-03,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 5,  6, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0032,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([26, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.6028e-06, -8.6151e-03,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 12, 13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.5367e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.5775e-05, -2.3842e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.1526e-07, -3.1352e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-9.5367e-07, -4.0173e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1, 7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0032,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([26, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.1623635292053223
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0008812197484076023
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2126973867416382
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6842073798179626
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.1526e-07, -3.1352e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.8279e-05, -7.4980e-05,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([16, 17, 25, 26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8068318367004395
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001784136169590056
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2126973867416382
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7097001075744629
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 60 zeros in ref_logprobs out of 853272576
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.0265e-05, -1.8158e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-8.9407e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0004,  0.0000,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([23, 29, 30], device='cuda:0'),)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 44 zeros in ref_logprobs out of 2688
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.0265e-05, -1.8158e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.4305e-06, -4.3264e-04, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22, 29], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([29, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.0265e-05, -1.8158e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.4305e-06, -4.3264e-04, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22, 29], device='cuda:0'),)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 168]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 351]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 351]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 168]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 168]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([29, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-0.0004,  0.0000,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23, 29, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-0.0004,  0.0000,  0.0000], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([23, 29, 30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.0265e-05, -1.8158e-02,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-8.9407e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([32], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5232111811637878
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006573017220944166
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5041522979736328
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6457688808441162
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07, -2.3842e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20, 26, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.5232111811637878
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0028603938408195972
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5041522979736328
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5990601778030396
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([27, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8690838813781738
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0009308661101385951
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9226953983306885
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.45052170753479004
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4563562870025635
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00042053338256664574
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2701581716537476
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.43813323974609375
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.37322574853897095
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0002994174137711525
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2766940593719482
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.2641180157661438
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.03642281889915466
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00021759807714261115
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0007045269012451
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.030943820253014565
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([27, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([27, 28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8690838813781738
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0008702227496542037
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9226953983306885
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4309760332107544
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4563562870025635
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00042053338256664574
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2310099601745605
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4072798192501068
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.37322574853897095
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0002994174137711525
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.184096097946167
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.27765515446662903
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.03642281889915466
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00021759807714261115
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0366249084472656
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.07537123560905457
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=14
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 55 zeros in ref_logprobs out of 683104256
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 39 zeros in ref_logprobs out of 1760
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 110]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 281]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 281]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 110]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 110]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=14
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 81 zeros in ref_logprobs out of 901892096
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 65 zeros in ref_logprobs out of 3136
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 196]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 371]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 371]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 196]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 196]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=14
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 28
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 29
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 28

[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 168, 151936]), responses shape: torch.Size([16, 168])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 168]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 351]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 351]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 168]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 110, 151936]), responses shape: torch.Size([16, 110])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62', '62'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 110]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 281]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 281]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 110]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 196, 151936]), responses shape: torch.Size([16, 196])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 196]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 371]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 371]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 196]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['400', '400', '400', '400', '400', '400', '400',...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 1...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 196])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 371])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 371])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 196])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 196])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 196])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 371])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 371])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 196])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 196])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=1, seq=0: ref_logprob=0.0000, pi_logprob=-5.0535, diff=5.0535, token_id=10244, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-5.0535, diff=5.0535, token_id=10244, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-5.0535, diff=5.0535, token_id=10244, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=4, seq=0: ref_logprob=0.0000, pi_logprob=-5.0535, diff=5.0535, token_id=10244, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-5.0535, diff=5.0535, token_id=10244, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 5.053515434265137
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.07795596122741699
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.1862597465515137
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8737205266952515
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.591886043548584
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003915053326636553
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.25257408618927
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9382191300392151
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.817561149597168
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.008321517147123814
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2682409286499023
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9728228449821472
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.623105525970459
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0046802121214568615
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.6658525466918945
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9433761239051819
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([16, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.0535], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([10244], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=0, seq=0: ref_logprob=0.0000, pi_logprob=-5.0535, diff=5.0535, token_id=10244, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=1, seq=0: ref_logprob=0.0000, pi_logprob=-5.0535, diff=5.0535, token_id=10244, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-5.0535, diff=5.0535, token_id=10244, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-5.0535, diff=5.0535, token_id=10244, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-5.0535, diff=5.0535, token_id=10244, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 5.053515434265137
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.07548441737890244
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.1862597465515137
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8670512437820435
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.591886043548584
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.007135810796171427
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.25257408618927
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9330319762229919
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.297905445098877
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.003578669624403119
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2682409286499023
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9723130464553833
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.3270344734191895
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.001757162157446146
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 3.6658525466918945
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9578640460968018
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 6,  7, 15, 16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.2994e-05, -1.1921e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7,  8, 12, 16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7499793767929077
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.003054836066439748
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2703341245651245
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9570721387863159
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.2994e-05, -1.1921e-07,  0.0000e+00,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7,  8, 12, 16, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7499793767929077
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0030210784170776606
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2703341245651245
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9765792489051819
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07, -2.3842e-07,  0.0000e+00, -2.3842e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 14, 18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8,  9, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07, -2.3842e-07,  0.0000e+00, -2.3842e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 14, 18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07, -2.3842e-07,  0.0000e+00, -2.3842e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 14, 18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8610e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -2.5034e-06, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([16, 17, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.35221993923187256
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.020161554217338562
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3900903463363647
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8233239650726318
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -4.7684e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8,  9, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -2.5034e-06, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16, 17, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -2.5034e-06, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16, 17, 21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.0054e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07, -2.3842e-07,  0.0000e+00, -2.3842e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 9, 10, 14, 18, 19], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8610e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-4.0054e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.2650e-06,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6, 10, 14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.35221993923187256
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.014074994251132011
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3900903463363647
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7867142558097839
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.0054e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.37340396642684937
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0011126353638246655
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0875552892684937
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.2986149787902832
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.0054e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.37340396642684937
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0007209518225863576
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4538873434066772
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.23419532179832458
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.0994e-06, -1.5497e-06,  0.0000e+00, -8.3446e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 11, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.0994e-06, -1.5497e-06,  0.0000e+00, -8.3446e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 11, 19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.003851601853966713
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0007208602037280798
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.0000029802322388
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.10441506654024124
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.003851601853966713
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 1.146629438153468e-05
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.000022530555725
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.07407274097204208
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=0, self.version=14, self.vllm_weight_versions[worker_id]=14
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 96 zeros in ref_logprobs out of 602882048
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 64 zeros in ref_logprobs out of 1680
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 105]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=14, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 248]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 248]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 105]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 105]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 29
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 29
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=2, self.version=14, self.vllm_weight_versions[worker_id]=14
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 97 zeros in ref_logprobs out of 862996480
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 65 zeros in ref_logprobs out of 3360
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 210]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=14, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 355]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 355]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 210]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 210]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.6569366389885545
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.9197875373065472
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 30
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['400', '400', '400', '400', '400', '400', '400',...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 1...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 210])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 355])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 355])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 210])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 210])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>

[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 105, 151936]), responses shape: torch.Size([16, 105])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 105]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=14, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 248]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 248]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 105]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 210, 151936]), responses shape: torch.Size([16, 210])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 210]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=14, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 355]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 355]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 210]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 210])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 355])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 355])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 210])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 210])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 77 zeros in ref_logprobs out of 1254383616
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 61 zeros in ref_logprobs out of 5936
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 371]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 516]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 516]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 371]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 371]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=15
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([962], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([962], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-3.7751, diff=3.7751, token_id=13, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=4, seq=0: ref_logprob=0.0000, pi_logprob=-3.7751, diff=3.7751, token_id=13, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-3.7751, diff=3.7751, token_id=13, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=7, seq=0: ref_logprob=0.0000, pi_logprob=-3.7751, diff=3.7751, token_id=13, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=14, seq=0: ref_logprob=0.0000, pi_logprob=-3.7751, diff=3.7751, token_id=13, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 3.77512788772583
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.049939416348934174
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5183908939361572
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8001287579536438
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([16, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -3.5763e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.3497713804244995
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.01800721511244774
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.640661597251892
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8133448958396912
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-4.7684e-07,  0.0000e+00,  0.0000e+00, -1.1921e-07,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 17, 22, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 1], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9064644575119019
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 6.884243339300156e-05
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2762234210968018
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8351885080337524
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-06,  0.0000e+00, -2.3842e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([13, 14, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6803240776062012
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0005023222183808684
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.0847954750061035
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8064898252487183
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.5497e-06, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18, 22, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18, 22, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    15,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([17, 18, 22, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.5497e-06, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.32718926668167114
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.01791992597281933
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7248692512512207
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6983250975608826
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.7751], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([13], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=0, seq=0: ref_logprob=0.0000, pi_logprob=-3.7751, diff=3.7751, token_id=13, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-3.7751, diff=3.7751, token_id=13, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=4, seq=0: ref_logprob=0.0000, pi_logprob=-3.7751, diff=3.7751, token_id=13, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-3.7751, diff=3.7751, token_id=13, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=6, seq=0: ref_logprob=0.0000, pi_logprob=-3.7751, diff=3.7751, token_id=13, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 3.77512788772583
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.10124603658914566
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4090162515640259
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.653026819229126
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4195690155029297
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.007970750331878662
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2545115947723389
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.699949324131012
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22, 26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22, 26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 15,  29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 0, 22, 23], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9009771347045898
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001999487867578864
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.1878998279571533
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8770374655723572
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 4, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -4.7684e-06,  0.0000e+00, -2.3842e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([13, 14, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0, 4, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6803240776062012
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0015310912858694792
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.1336328983306885
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8576198220252991
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.5497e-06, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0., 0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 13, 17, 18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.24536943435668945
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003826888743788004
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7248692512512207
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.858363687992096
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.3113e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.3113e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.030085628852248192
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -4.308151619625278e-05
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2795355319976807
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7585309147834778
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.3113e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([7, 8], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.32915860414505005
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.001077734399586916
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2795355319976807
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.4799056351184845
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: -0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3913049697875977
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.5529125332832336
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.12174654006958008
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0001380469766445458
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3913049697875977
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3468608856201172
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.231797695159912
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.18074993789196014
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([19, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.05158564820885658
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0008609462529420853
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.231797695159912
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.19434507191181183
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 57 zeros in ref_logprobs out of 1064767488
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 41 zeros in ref_logprobs out of 4080
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 255]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=14, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 438]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 438]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 255]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 255]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 30
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 31
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 30
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 371])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 516])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 516])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 371])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 371])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['1000', '1000', '1000', '1000', '1000', '1000', ...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [13, 14, 14, 14, 13, 13, 13, 13, 14, 13, 13, 14, 1...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 371])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 516])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 516])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 371])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 371])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=15
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 2
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([45, 46], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([44], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([44], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=1, seq=0: ref_logprob=0.0000, pi_logprob=-10.3782, diff=10.3782, token_id=29, mask_value=True
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=3, self.version=15, self.vllm_weight_versions[worker_id]=15
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([45, 46], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-10.3782, diff=10.3782, token_id=29, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-10.3782, diff=10.3782, token_id=29, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=8, seq=0: ref_logprob=0.0000, pi_logprob=-10.3782, diff=10.3782, token_id=29, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=11, seq=0: ref_logprob=0.0000, pi_logprob=-10.3782, diff=10.3782, token_id=29, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 10.378210067749023
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.07846161723136902
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4357998371124268
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8735657334327698
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([20], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([40], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([20], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([40], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 2, 42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 15, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 2, 34, 35], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-10.3782], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.533104419708252
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.011993354186415672
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6159980297088623
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9718127846717834
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=0, seq=0: ref_logprob=0.0000, pi_logprob=-10.3782, diff=10.3782, token_id=29, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=2, seq=0: ref_logprob=0.0000, pi_logprob=-10.3782, diff=10.3782, token_id=29, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=3, seq=0: ref_logprob=0.0000, pi_logprob=-10.3782, diff=10.3782, token_id=29, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=4, seq=0: ref_logprob=0.0000, pi_logprob=-10.3782, diff=10.3782, token_id=29, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=5, seq=0: ref_logprob=0.0000, pi_logprob=-10.3782, diff=10.3782, token_id=29, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 10.378210067749023
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.11994141340255737
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3948309421539307
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8309207558631897
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00, -1.7047e-05,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 15,  20,  15, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 0, 20, 27, 39, 44], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00, -1.7047e-05,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 15,  20,  15, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 0, 20, 27, 39, 44], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3, 43], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([44], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3, 43], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([6], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7881e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([46], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([44], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 20, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8, 28, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=13, seq=41: ref_logprob=-0.1214, pi_logprob=-3.3848, diff=3.2633, token_id=23586, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 3.263309955596924
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.013190457597374916
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.1671230792999268
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9254233837127686
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2, 42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 15, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2, 34, 35], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 2, 42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4998093843460083
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00045429286547005177
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2678325176239014
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9619249701499939
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.6291e-05, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([44], device='cuda:0'),)
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 2 self.version=15
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.6291e-05, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([1, 2], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7881e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([44], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([28], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 20, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8, 28, 33], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=15, seq=41: ref_logprob=-0.1214, pi_logprob=-3.3848, diff=3.2633, token_id=23586, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=29, seq=41: ref_logprob=-0.1214, pi_logprob=-3.3848, diff=3.2633, token_id=23586, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 3.263309955596924
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.01113692857325077
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.173780918121338
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8906304836273193
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([20, 15, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 16, 41], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29, 20], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29, 20], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.9605e-07, -9.7652e-03,  0.0000e+00, -1.1921e-07,  0.0000e+00],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 13, 366,  15,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 7, 26, 31, 32, 35], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([20, 15, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([11, 16, 41], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07, -7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.0729e-06, -5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 8, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Large diff at batch=22, seq=10: ref_logprob=-0.1269, pi_logprob=-3.5312, diff=3.4043, token_id=29, mask_value=True
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 3.4042956829071045
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.02518008090555668
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3291881084442139
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.820018470287323
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 20], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 20], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 3, 27], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([34], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3647496700286865
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.000363037979695946
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4168754816055298
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6924856901168823
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0., 0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 1, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07, -2.3842e-07, -3.4571e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15, 15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([1, 2, 5], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.4835665225982666
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.023972760885953903
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4384444952011108
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.3796868622303009
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.36328861117362976
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00021599279716610909
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.186631679534912
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.08032683283090591
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([30], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([16], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.9605e-07, -9.7652e-03,  0.0000e+00, -1.1921e-07,  0.0000e+00],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 13, 366,  15,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 7, 26, 31, 32, 35], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.0729e-06, -5.9605e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 8, 17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Large diff at batch=10, seq=10: ref_logprob=-0.1269, pi_logprob=-3.5312, diff=3.4043, token_id=29, mask_value=True
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 3.4042956829071045
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.012096196413040161
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.853220820426941
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8716995120048523
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3647496700286865
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0005541634163819253
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3575190305709839
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.7742409706115723
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([42], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.1615750789642334
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.02569318190217018
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.3342350721359253
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.48165541887283325
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.003384687937796116
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004611622542142868
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2159284353256226
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.06165308877825737
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.36328861117362976
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00043194458703510463
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.186631679534912
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.09481439739465714
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.003384687937796116
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.009223245084285736
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2159284353256226
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.09223362803459167
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 83 zeros in ref_logprobs out of 945649664

[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 371, 151936]), responses shape: torch.Size([16, 371])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 371]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=13, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 516]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 516]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 371]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 255, 151936]), responses shape: torch.Size([16, 255])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110', '110'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 255]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=14, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 438]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 438]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 255]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 214, 151936]), responses shape: torch.Size([16, 214])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 214]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=14, batch_size=torch.Size([]), device=cuda:0),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 67 zeros in ref_logprobs out of 3424
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 214]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=14, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 389]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 389]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 214]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 214]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=15
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=1, self.version=15, self.vllm_weight_versions[worker_id]=15
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 96 zeros in ref_logprobs out of 729292800
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 64 zeros in ref_logprobs out of 2352
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 147]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 300]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 300]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 147]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 147]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 31
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight gather
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 31
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=2, self.version=15, self.vllm_weight_versions[worker_id]=15
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done gather in 0.8764798529446125
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:started weight sync
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Done sync in 0.7815450485795736
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 32
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 214])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 389])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 389])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 214])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 214])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 3
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 got from queue traj Trajectory(
[36m(PyTorchActorModel pid=3151119)[0m     advantages=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     answers=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [['400', '400', '400', '400', '400', '400', '400',...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     policy_version=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [14, 14, 14, 14, 15, 14, 15, 15, 15, 15, 14, 15, 1...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     query_response_padding_masks=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     query_responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     ref_logprobs=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     responses=Tensor(shape=torch.Size([32, -1]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     reward_metadata=NonTensorStack(
[36m(PyTorchActorModel pid=3151119)[0m         [{'func_names': ['at_least_one_space_between_think...,
[36m(PyTorchActorModel pid=3151119)[0m         batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m         device=cuda:0),
[36m(PyTorchActorModel pid=3151119)[0m     rewards=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     seq_lens=Tensor(shape=torch.Size([32]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     successes=Tensor(shape=torch.Size([32, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(PyTorchActorModel pid=3151119)[0m     batch_size=torch.Size([32]),
[36m(PyTorchActorModel pid=3151119)[0m     device=cuda:0,
[36m(PyTorchActorModel pid=3151119)[0m     is_shared=True)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 214])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 389])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 389])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 214])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 214])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 63 zeros in ref_logprobs out of 1227642880
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 47 zeros in ref_logprobs out of 5760
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 360]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=14, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 505]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 505]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 360]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 360]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 3 self.version=16

[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 389]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 389]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 214]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 147, 151936]), responses shape: torch.Size([16, 147])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 147]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 300]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 300]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 147]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151100)[0m 2 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(PyTorchActorModel pid=3151119)[0m ----
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 360, 151936]), responses shape: torch.Size([16, 360])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000', '1000'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 360]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=14, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 505]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 505]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 360]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 162, 151936]), responses shape: torch.Size([16, 162])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([]), device=cuda:0),[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 78 zeros in ref_logprobs out of 746309632
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 46 zeros in ref_logprobs out of 2592
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 162]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 307]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 307]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 162]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 162]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([16], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([16, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([16, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 7 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 8 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 9 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([16, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07, -7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([16, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([16, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 21 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 17 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 18 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 19 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([16, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 22 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 24 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 30 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.70030677318573
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.01083761639893055
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 11.271809577941895
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.904168426990509
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 25 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([16], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 29 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.7003], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([374], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([16], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([16], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([17], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -7.1526e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([16, 15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 1.70030677318573
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.004682034719735384
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 11.271809577941895
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8838835954666138
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.19835281372070312
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.00441326666623354
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8719197511672974
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9295403361320496
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6062197685241699
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.013156323693692684
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8719197511672974
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9301905632019043
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8610858917236328
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00557676749303937
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9739036560058594
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9328663945198059
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8610e-06, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.737544059753418
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.0007489515701308846
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.9739036560058594
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9294039607048035
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.8610e-06, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.8393430709838867
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.007209792733192444
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.6395924091339111
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9928814768791199
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8610e-06, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8610e-06, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22, 26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 6 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8610e-06, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-2.8610e-06, -4.7684e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.6179957389831543
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.006577867548912764
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.9605e-07, -2.7656e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8818449974060059
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9933193325996399
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.9605e-07, -2.7656e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7454624176025391
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.003720806213095784
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7866822481155396
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.9481654763221741
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 1 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -3.5763e-07,  0.0000e+00, -2.3842e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 17, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 2 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -1.1921e-07, -1.1921e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366,  15], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([21, 22, 26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 4 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-8.3446e-07, -2.8610e-06], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 10 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 20 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 16 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.9605e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-5.9605e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([2, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.19338452816009521
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0029549868777394295
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 23 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([18], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.9605e-07, -2.7656e-05], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([ 29, 366], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([24, 25], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -3.5763e-07,  0.0000e+00, -2.3842e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([12, 13, 17, 21, 22], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.8807201385498047
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8245033621788025
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-3.5763e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([26], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 31 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([0.], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.7454624176025391
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.0011432437459006906
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.7542071342468262
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.8768866658210754
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -7.4980e-05, -5.9605e-07,  0.0000e+00, -4.7684e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2,  6, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 11 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-1.1921e-07,  0.0000e+00,  0.0000e+00], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([366,  15,  29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([12, 16, 20], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 5 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([3, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 15 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.9605e-07, -3.6955e-06, -2.3842e-07,  0.0000e+00, -4.7684e-07],
[36m(PyTorchActorModel pid=3151119)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 5,  6,  8, 14, 15], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 12 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([ 0.0000e+00, -2.3842e-07], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([3, 4], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 14 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -7.4980e-05, -5.9605e-07,  0.0000e+00, -4.7684e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2,  6, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-5.9605e-07,  0.0000e+00, -4.7684e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([2, 6, 7], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([ 0.0000e+00,  0.0000e+00, -5.9605e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([   366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([0, 8, 9], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.288118839263916
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.001982650253921747
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 27 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-3.5763e-07,  0.0000e+00], device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([15, 29], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([10, 14], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 28 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-2.3842e-07, -7.4980e-05, -5.9605e-07,  0.0000e+00, -4.7684e-07],
[36m(PyTorchActorModel pid=3151076)[0m        device='cuda:0', grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     15,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([ 1,  2,  6, 10, 11], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9740757942199707
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.005475911777466536
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.2329679727554321
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.47463569045066833
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.5027642250061035
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.6581546068191528
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 0 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-1.1921e-07, -2.3842e-07,  0.0000e+00, -2.3842e-07], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([ 2,  3, 11, 12], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 13 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.1526e-07, -3.6955e-06,  0.0000e+00, -1.1921e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 15, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.9740757942199707
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: -0.014477085322141647
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 2.815532684326172
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.40571776032447815
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Batch 26 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151076)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m pi_logprobs: tensor([-7.1526e-07, -3.6955e-06,  0.0000e+00, -1.1921e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151076)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151076)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151076)[0m indices: (tensor([14, 15, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3884577751159668
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00039437541272491217
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4405943155288696
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.18008296191692352
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Batch 3 - Positions where ref_logprobs == 0 (unmasked):
[36m(PyTorchActorModel pid=3151119)[0m ref_logprobs: tensor([0., 0., 0., 0.], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m pi_logprobs: tensor([-7.1526e-07, -3.6955e-06,  0.0000e+00, -1.1921e-06], device='cuda:0',
[36m(PyTorchActorModel pid=3151119)[0m        grad_fn=<IndexBackward0>),
[36m(PyTorchActorModel pid=3151119)[0m mask_values: tensor([True, True, True, True], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m token_ids: tensor([    29,    366,     29, 151643], device='cuda:0'),
[36m(PyTorchActorModel pid=3151119)[0m indices: (tensor([14, 15, 23, 24], device='cuda:0'),)
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max ref_logprobs - pi_logprobs: 0.3884577751159668
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean ref_logprobs - pi_logprobs: 0.00019718767725862563
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean advantage: 0.0
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Max policy ratio: 1.4405943155288696
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:Mean policy ratio: 0.09161000698804855
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 88 zeros in ref_logprobs out of 683104256
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 56 zeros in ref_logprobs out of 2208
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 138]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 281]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 281]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 138]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 138]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 1
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 67 zeros in ref_logprobs out of 1040457728
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 35 zeros in ref_logprobs out of 3568
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 223]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 428]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 428]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 223]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 223]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:in _sync_weights_with_worker 0
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 1 self.version=16
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 83 zeros in ref_logprobs out of 865427456
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 67 zeros in ref_logprobs out of 2896
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 181]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 356]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 356]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 181]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 181]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:self.rank=0 finished step 32
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:logging metrics at step 33
[36m(PyTorchActorModel pid=3151119)[0m INFO:torchtune.utils._logging:done logging metrics
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:_sync_weights_with_worker done broadcast 0 self.version=16
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:self.rank=1 finished step 32
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:After model call: 89 zeros in ref_logprobs out of 921339904
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Before padding: 57 zeros in ref_logprobs out of 3616
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Constructed trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     advantages=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200'], batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 226]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 379]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 379]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=Tensor(shape=torch.Size([16, 226]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 226]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     reward_metadata=NonTensorData(data={'func_names': ['at_least_one_space_between_think_tags', 'math_response_correct']}, batch_size=torch.Size([16]), device=None),
[36m(RefActor pid=3151242)[0m     rewards=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     successes=Tensor(shape=torch.Size([16, 2]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([16]),
[36m(RefActor pid=3151242)[0m     device=None,
[36m(RefActor pid=3151242)[0m     is_shared=False)

[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 162]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 307]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 307]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 162]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 138, 151936]), responses shape: torch.Size([16, 138])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8', '8'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 138]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 281]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 281]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 138]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151108)[0m 1 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 223, 151936]), responses shape: torch.Size([16, 223])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10', '10'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 223]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 428]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 428]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 223]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(LLMCollector( pid=3151206)[0m 0 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 181, 151936]), responses shape: torch.Size([16, 181])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400', '400'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 181]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 356]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 356]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 181]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
[36m(RefActor pid=3151242)[0m ref_logits shape: torch.Size([16, 226, 151936]), responses shape: torch.Size([16, 226])
[36m(RefActor pid=3151242)[0m Extracting components from raw trajectory: Trajectory(
[36m(RefActor pid=3151242)[0m     answers=NonTensorData(data=['1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200', '1200'], batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     logprobs=Tensor(shape=torch.Size([16, 226]), device=cuda:0, dtype=torch.float32, is_shared=True),
[36m(RefActor pid=3151242)[0m     policy_version=NonTensorData(data=15, batch_size=torch.Size([]), device=cuda:0),
[36m(RefActor pid=3151242)[0m     query_response_padding_masks=Tensor(shape=torch.Size([16, 379]), device=cuda:0, dtype=torch.bool, is_shared=True),
[36m(RefActor pid=3151242)[0m     query_responses=Tensor(shape=torch.Size([16, 379]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     responses=Tensor(shape=torch.Size([16, 226]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     seq_lens=Tensor(shape=torch.Size([16]), device=cuda:0, dtype=torch.int64, is_shared=True),
[36m(RefActor pid=3151242)[0m     ref_logprobs=None,
[36m(RefActor pid=3151242)[0m     rewards=None,
[36m(RefActor pid=3151242)[0m     advantages=None,
[36m(RefActor pid=3151242)[0m     successes=None,
[36m(RefActor pid=3151242)[0m     reward_metadata=None,
[36m(RefActor pid=3151242)[0m     batch_size=torch.Size([]),
[36m(RefActor pid=3151242)[0m     device=cuda:0,
[36m(RefActor pid=3151242)[0m     is_shared=True)
Traceback (most recent call last):
  File "/data/users/felipemello/r1-zero/scripts/runnable_recipe_ray_vllm_weight_sync.py", line 2228, in <module>
    recipe_main()
  File "/data/users/felipemello/r1-zero/torchtune/config/_parse.py", line 99, in wrapper
    sys.exit(recipe_main(conf))
             ^^^^^^^^^^^^^^^^^
  File "/data/users/felipemello/r1-zero/scripts/runnable_recipe_ray_vllm_weight_sync.py", line 2223, in recipe_main
    recipe.train()
  File "/data/users/felipemello/r1-zero/scripts/runnable_recipe_ray_vllm_weight_sync.py", line 2206, in train
    ray.get(rollout_handles + ref_handles + worker_handles)
  File "/home/felipemello/.conda/envs/torchtune_vllm/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/felipemello/.conda/envs/torchtune_vllm/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/felipemello/.conda/envs/torchtune_vllm/lib/python3.11/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/felipemello/.conda/envs/torchtune_vllm/lib/python3.11/site-packages/ray/_private/worker.py", line 893, in get_objects
    ] = self.core_worker.get_objects(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "python/ray/_raylet.pyx", line 3189, in ray._raylet.CoreWorker.get_objects
  File "python/ray/includes/common.pxi", line 83, in ray._raylet.check_status
KeyboardInterrupt
[36m(vLLMParameterServer pid=3151482)[0m INFO:torchtune.utils._logging:skipping update for worker_id=3, self.version=16, self.vllm_weight_versions[worker_id]=16
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padding values: {'query_responses': 151643, 'responses': 151643, 'logprobs': 0.0, 'ref_logprobs': 0.0, 'query_response_padding_masks': False}
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Sequence keys: ['query_responses', 'responses', 'logprobs', 'ref_logprobs', 'query_response_padding_masks']
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'advantages' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'answers' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'logprobs' to shape torch.Size([32, 223])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'policy_version' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_response_padding_masks' to shape torch.Size([32, 428])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'query_responses' to shape torch.Size([32, 428])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'ref_logprobs' to shape torch.Size([32, 223])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Padded 'responses' to shape torch.Size([32, 223])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'reward_metadata' as <class 'list'>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'rewards' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'seq_lens' with shape torch.Size([32])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:Got 'successes' with shape torch.Size([32, 2])
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([151643, 151643, 151643, 151643, 151643], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:query response: tensor([   32, 10435,  1948,  2657,   323], device='cuda:0')
[36m(PyTorchActorModel pid=3151076)[0m INFO:torchtune.utils._logging:A conversation between User and
[36m(RefActor pid=3151242)[0m INFO:torchtune.utils._logging:Getting from rollout_queue queue.
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(PyTorchActorModel pid=3151076)[0m ----
[36m(LLMCollector( pid=3151212)[0m 3 about to update weights, Actor(vLLMParameterServer, 69efd756a9d0af41f6b7663401000000)
